"use strict";var t=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t,e){var r,n=(r="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(t){var e;t=t||{},e||(e=void 0!==t?t:{});var n,s={};for(n in e)e.hasOwnProperty(n)&&(s[n]=e[n]);var _,c="";c=self.location.href,r&&(c=r),c=0!==c.indexOf("blob:")?c.substr(0,c.lastIndexOf("/")+1):"",_=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)};var a,o=e.print||console.log.bind(console),i=e.printErr||console.warn.bind(console);for(n in s)s.hasOwnProperty(n)&&(e[n]=s[n]);s=null,e.wasmBinary&&(a=e.wasmBinary),e.noExitRuntime&&e.noExitRuntime,"object"!=typeof WebAssembly&&i("no native wasm support detected");var u,l,f,h,d,p,v=new WebAssembly.Table({initial:255,maximum:255,element:"anyfunc"}),m=!1,y="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function w(t,e,r){var n=e+r;for(r=e;t[r]&&!(r>=n);)++r;if(16<r-e&&t.subarray&&y)return y.decode(t.subarray(e,r));for(n="";e<r;){var s=t[e++];if(128&s){var _=63&t[e++];if(192==(224&s))n+=String.fromCharCode((31&s)<<6|_);else{var c=63&t[e++];65536>(s=224==(240&s)?(15&s)<<12|_<<6|c:(7&s)<<18|_<<12|c<<6|63&t[e++])?n+=String.fromCharCode(s):(s-=65536,n+=String.fromCharCode(55296|s>>10,56320|1023&s))}}else n+=String.fromCharCode(s)}return n}function g(t){l=t,e.HEAP8=f=new Int8Array(t),e.HEAP16=d=new Int16Array(t),e.HEAP32=p=new Int32Array(t),e.HEAPU8=h=new Uint8Array(t),e.HEAPU16=new Uint16Array(t),e.HEAPU32=new Uint32Array(t),e.HEAPF32=new Float32Array(t),e.HEAPF64=new Float64Array(t)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var P=e.INITIAL_MEMORY||16777216;function E(t){for(;0<t.length;){var r=t.shift();if("function"==typeof r)r();else{var n=r.Oc;"number"==typeof n?void 0===r.wc?e.dynCall_v(n):e.dynCall_vi(n,r.wc):n(void 0===r.wc?null:r.wc)}}}(u=e.wasmMemory?e.wasmMemory:new WebAssembly.Memory({initial:P/65536}))&&(l=u.buffer),P=l.byteLength,g(l),p[19360]=5320480;var x=[],A=[],b=[],C=[];function N(){var t=e.preRun.shift();x.unshift(t)}var I=Math.abs,T=Math.ceil,R=Math.floor,k=Math.min,S=0,F=null;function L(t){throw e.onAbort&&e.onAbort(t),o(t),i(t),m=!0,new WebAssembly.RuntimeError("abort("+t+"). Build with -s ASSERTIONS=1 for more info.")}function z(){var t=K;return String.prototype.startsWith?t.startsWith("data:application/octet-stream;base64,"):0===t.indexOf("data:application/octet-stream;base64,")}e.preloadedImages={},e.preloadedAudios={};var M,D,K="libratchet.worker.wasm";if(!z()){var O=K;K=e.locateFile?e.locateFile(O,c):c+O}function B(){try{if(a)return new Uint8Array(a);if(_)return _(K);throw"both async and sync fetching of the wasm failed"}catch(t){L(t)}}function H(t,e){for(var r=0,n=t.length-1;0<=n;n--){var s=t[n];"."===s?t.splice(n,1):".."===s?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r;r--)t.unshift("..");return t}function U(t){var e="/"===t.charAt(0),r="/"===t.substr(-1);return(t=H(t.split("/").filter((function(t){return!!t})),!e).join("/"))||e||(t="."),t&&r&&(t+="/"),(e?"/":"")+t}function Y(t){var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(t).slice(1);return t=e[0],e=e[1],t||e?(e&&(e=e.substr(0,e.length-1)),t+e):"."}function G(t){if("/"===t)return"/";var e=t.lastIndexOf("/");return-1===e?t:t.substr(e+1)}function $(){for(var t="",e=!1,r=arguments.length-1;-1<=r&&!e;r--){if("string"!=typeof(e=0<=r?arguments[r]:"/"))throw new TypeError("Arguments to path.resolve must be strings");if(!e)return"";t=e+"/"+t,e="/"===e.charAt(0)}return(e?"/":"")+(t=H(t.split("/").filter((function(t){return!!t})),!e).join("/"))||"."}A.push({Oc:function(){Bt()}});var W=[];function j(t,e){W[t]={input:[],hc:[],pc:e},wt(t,V)}var V={open:function(t){var e=W[t.node.uc];if(!e)throw new _t(43);t.gc=e,t.seekable=!1},close:function(t){t.gc.pc.flush(t.gc)},flush:function(t){t.gc.pc.flush(t.gc)},read:function(t,e,r,n){if(!t.gc||!t.gc.pc.Fc)throw new _t(60);for(var s=0,_=0;_<n;_++){try{var c=t.gc.pc.Fc(t.gc)}catch(t){throw new _t(29)}if(void 0===c&&0===s)throw new _t(6);if(null==c)break;s++,e[r+_]=c}return s&&(t.node.timestamp=Date.now()),s},write:function(t,e,r,n){if(!t.gc||!t.gc.pc.yc)throw new _t(60);try{for(var s=0;s<n;s++)t.gc.pc.yc(t.gc,e[r+s])}catch(t){throw new _t(29)}return n&&(t.node.timestamp=Date.now()),s}},Z={Fc:function(t){if(!t.input.length){var e=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(e=window.prompt("Input: "))&&(e+="\n"):"function"==typeof readline&&null!==(e=readline())&&(e+="\n"),!e)return null;for(var r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++n)),127>=s?++r:r=2047>=s?r+2:65535>=s?r+3:r+4}var _=(r=Array(r+1)).length;if(n=0,0<_){s=n,_=n+_-1;for(var c=0;c<e.length;++c){var a=e.charCodeAt(c);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++c)),127>=a){if(n>=_)break;r[n++]=a}else{if(2047>=a){if(n+1>=_)break;r[n++]=192|a>>6}else{if(65535>=a){if(n+2>=_)break;r[n++]=224|a>>12}else{if(n+3>=_)break;r[n++]=240|a>>18,r[n++]=128|a>>12&63}r[n++]=128|a>>6&63}r[n++]=128|63&a}}r[n]=0,e=n-s}else e=0;r.length=e,t.input=r}return t.input.shift()},yc:function(t,e){null===e||10===e?(o(w(t.hc,0)),t.hc=[]):0!=e&&t.hc.push(e)},flush:function(t){t.hc&&0<t.hc.length&&(o(w(t.hc,0)),t.hc=[])}},X={yc:function(t,e){null===e||10===e?(i(w(t.hc,0)),t.hc=[]):0!=e&&t.hc.push(e)},flush:function(t){t.hc&&0<t.hc.length&&(i(w(t.hc,0)),t.hc=[])}},q={ic:null,kc:function(){return q.createNode(null,"/",16895,0)},createNode:function(t,e,r,n){if(24576==(61440&r)||4096==(61440&r))throw new _t(63);return q.ic||(q.ic={dir:{node:{mc:q.dc.mc,jc:q.dc.jc,qc:q.dc.qc,sc:q.dc.sc,Kc:q.dc.Kc,Mc:q.dc.Mc,Lc:q.dc.Lc,Jc:q.dc.Jc,vc:q.dc.vc},stream:{oc:q.ec.oc}},file:{node:{mc:q.dc.mc,jc:q.dc.jc},stream:{oc:q.ec.oc,read:q.ec.read,write:q.ec.write,Ac:q.ec.Ac,Gc:q.ec.Gc,Ic:q.ec.Ic}},link:{node:{mc:q.dc.mc,jc:q.dc.jc,rc:q.dc.rc},stream:{}},Bc:{node:{mc:q.dc.mc,jc:q.dc.jc},stream:yt}}),16384==(61440&(r=lt(t,e,r,n)).mode)?(r.dc=q.ic.dir.node,r.ec=q.ic.dir.stream,r.cc={}):32768==(61440&r.mode)?(r.dc=q.ic.file.node,r.ec=q.ic.file.stream,r.fc=0,r.cc=null):40960==(61440&r.mode)?(r.dc=q.ic.link.node,r.ec=q.ic.link.stream):8192==(61440&r.mode)&&(r.dc=q.ic.Bc.node,r.ec=q.ic.Bc.stream),r.timestamp=Date.now(),t&&(t.cc[e]=r),r},$c:function(t){if(t.cc&&t.cc.subarray){for(var e=[],r=0;r<t.fc;++r)e.push(t.cc[r]);return e}return t.cc},ad:function(t){return t.cc?t.cc.subarray?t.cc.subarray(0,t.fc):new Uint8Array(t.cc):new Uint8Array(0)},Cc:function(t,e){var r=t.cc?t.cc.length:0;r>=e||(e=Math.max(e,r*(1048576>r?2:1.125)|0),0!=r&&(e=Math.max(e,256)),r=t.cc,t.cc=new Uint8Array(e),0<t.fc&&t.cc.set(r.subarray(0,t.fc),0))},Sc:function(t,e){if(t.fc!=e)if(0==e)t.cc=null,t.fc=0;else{if(!t.cc||t.cc.subarray){var r=t.cc;t.cc=new Uint8Array(e),r&&t.cc.set(r.subarray(0,Math.min(e,t.fc)))}else if(t.cc||(t.cc=[]),t.cc.length>e)t.cc.length=e;else for(;t.cc.length<e;)t.cc.push(0);t.fc=e}},dc:{mc:function(t){var e={};return e.Zc=8192==(61440&t.mode)?t.id:1,e.cd=t.id,e.mode=t.mode,e.ed=1,e.uid=0,e.bd=0,e.uc=t.uc,16384==(61440&t.mode)?e.size=4096:32768==(61440&t.mode)?e.size=t.fc:40960==(61440&t.mode)?e.size=t.link.length:e.size=0,e.Wc=new Date(t.timestamp),e.dd=new Date(t.timestamp),e.Yc=new Date(t.timestamp),e.Nc=4096,e.Xc=Math.ceil(e.size/e.Nc),e},jc:function(t,e){void 0!==e.mode&&(t.mode=e.mode),void 0!==e.timestamp&&(t.timestamp=e.timestamp),void 0!==e.size&&q.Sc(t,e.size)},qc:function(){throw ct[44]},sc:function(t,e,r,n){return q.createNode(t,e,r,n)},Kc:function(t,e,r){if(16384==(61440&t.mode)){try{var n=ut(e,r)}catch(t){}if(n)for(var s in n.cc)throw new _t(55)}delete t.parent.cc[t.name],t.name=r,e.cc[r]=t,t.parent=e},Mc:function(t,e){delete t.cc[e]},Lc:function(t,e){var r,n=ut(t,e);for(r in n.cc)throw new _t(55);delete t.cc[e]},Jc:function(t){var e,r=[".",".."];for(e in t.cc)t.cc.hasOwnProperty(e)&&r.push(e);return r},vc:function(t,e,r){return(t=q.createNode(t,e,41471,0)).link=r,t},rc:function(t){if(40960!=(61440&t.mode))throw new _t(28);return t.link}},ec:{read:function(t,e,r,n,s){var _=t.node.cc;if(s>=t.node.fc)return 0;if(8<(t=Math.min(t.node.fc-s,n))&&_.subarray)e.set(_.subarray(s,s+t),r);else for(n=0;n<t;n++)e[r+n]=_[s+n];return t},write:function(t,e,r,n,s,_){if(e.buffer===f.buffer&&(_=!1),!n)return 0;if((t=t.node).timestamp=Date.now(),e.subarray&&(!t.cc||t.cc.subarray)){if(_)return t.cc=e.subarray(r,r+n),t.fc=n;if(0===t.fc&&0===s)return t.cc=e.slice(r,r+n),t.fc=n;if(s+n<=t.fc)return t.cc.set(e.subarray(r,r+n),s),n}if(q.Cc(t,s+n),t.cc.subarray&&e.subarray)t.cc.set(e.subarray(r,r+n),s);else for(_=0;_<n;_++)t.cc[s+_]=e[r+_];return t.fc=Math.max(t.fc,s+n),n},oc:function(t,e,r){if(1===r?e+=t.position:2===r&&32768==(61440&t.node.mode)&&(e+=t.node.fc),0>e)throw new _t(28);return e},Ac:function(t,e,r){q.Cc(t.node,e+r),t.node.fc=Math.max(t.node.fc,e+r)},Gc:function(t,e,r,n,s,_,c){if(32768!=(61440&t.node.mode))throw new _t(43);if(t=t.node.cc,2&c||t.buffer!==e.buffer){if((0<s||s+n<t.length)&&(t=t.subarray?t.subarray(s,s+n):Array.prototype.slice.call(t,s,s+n)),s=!0,c=e.buffer==f.buffer,!(n=Ut(n)))throw new _t(48);(c?f:e).set(t,n)}else s=!1,n=t.byteOffset;return{gd:n,Vc:s}},Ic:function(t,e,r,n,s){if(32768!=(61440&t.node.mode))throw new _t(43);return 2&s||q.ec.write(t,e,0,n,r,!1),0}}},J=null,Q={},tt=[],et=1,rt=null,nt=!0,st={},_t=null,ct={};function at(t,e){if(e=e||{},!(t=$("/",t)))return{path:"",node:null};var r,n={Ec:!0,zc:0};for(r in n)void 0===e[r]&&(e[r]=n[r]);if(8<e.zc)throw new _t(32);t=H(t.split("/").filter((function(t){return!!t})),!1);var s=J;for(n="/",r=0;r<t.length;r++){var _=r===t.length-1;if(_&&e.parent)break;if(s=ut(s,t[r]),n=U(n+"/"+t[r]),s.tc&&(!_||_&&e.Ec)&&(s=s.tc.root),!_||e.Dc)for(_=0;40960==(61440&s.mode);)if(s=bt(n),s=at(n=$(Y(n),s),{zc:e.zc}).node,40<_++)throw new _t(32)}return{path:n,node:s}}function ot(t){for(var e;;){if(t===t.parent)return t=t.kc.Hc,e?"/"!==t[t.length-1]?t+"/"+e:t+e:t;e=e?t.name+"/"+e:t.name,t=t.parent}}function it(t,e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n)|0;return(t+r>>>0)%rt.length}function ut(t,e){var r;if(r=(r=dt(t,"x"))?r:t.dc.qc?0:2)throw new _t(r,t);for(r=rt[it(t.id,e)];r;r=r.Rc){var n=r.name;if(r.parent.id===t.id&&n===e)return r}return t.dc.qc(t,e)}function lt(t,e,r,n){return e=it((t=new Dt(t,e,r,n)).parent.id,t.name),t.Rc=rt[e],rt[e]=t}var ft={r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218};function ht(t){var e=["r","w","rw"][3&t];return 512&t&&(e+="w"),e}function dt(t,e){return nt||(-1===e.indexOf("r")||292&t.mode)&&(-1===e.indexOf("w")||146&t.mode)&&(-1===e.indexOf("x")||73&t.mode)?0:2}function pt(t,e){try{return ut(t,e),20}catch(t){}return dt(t,"wx")}function vt(t,e){kt||((kt=function(){}).prototype={});var r,n=new kt;for(r in t)n[r]=t[r];return t=n,e=function(t){for(t=t||0;t<=4096;t++)if(!tt[t])return t;throw new _t(33)}(e),t.lc=e,tt[e]=t}var mt,yt={open:function(t){t.ec=Q[t.node.uc].ec,t.ec.open&&t.ec.open(t)},oc:function(){throw new _t(70)}};function wt(t,e){Q[t]={ec:e}}function gt(t,e){var r="/"===e,n=!e;if(r&&J)throw new _t(10);if(!r&&!n){var s=at(e,{Ec:!1});if(e=s.path,(s=s.node).tc)throw new _t(10);if(16384!=(61440&s.mode))throw new _t(54)}e={type:t,fd:{},Hc:e,Qc:[]},(t=t.kc(e)).kc=e,e.root=t,r?J=t:s&&(s.tc=e,s.kc&&s.kc.Qc.push(e))}function Pt(t,e,r){var n=at(t,{parent:!0}).node;if(!(t=G(t))||"."===t||".."===t)throw new _t(28);var s=pt(n,t);if(s)throw new _t(s);if(!n.dc.sc)throw new _t(63);return n.dc.sc(n,t,e,r)}function Et(t){Pt(t,16895,0)}function xt(t,e,r){void 0===r&&(r=e,e=438),Pt(t,8192|e,r)}function At(t,e){if(!$(t))throw new _t(44);var r=at(e,{parent:!0}).node;if(!r)throw new _t(44);var n=pt(r,e=G(e));if(n)throw new _t(n);if(!r.dc.vc)throw new _t(63);r.dc.vc(r,e,t)}function bt(t){if(!(t=at(t).node))throw new _t(44);if(!t.dc.rc)throw new _t(28);return $(ot(t.parent),t.dc.rc(t))}function Ct(t,r,n,s){if(""===t)throw new _t(44);if("string"==typeof r){var _=ft[r];if(void 0===_)throw Error("Unknown file open mode: "+r);r=_}if(n=64&r?4095&(void 0===n?438:n)|32768:0,"object"==typeof t)var c=t;else{t=U(t);try{c=at(t,{Dc:!(131072&r)}).node}catch(t){}}if(_=!1,64&r)if(c){if(128&r)throw new _t(20)}else c=Pt(t,n,0),_=!0;if(!c)throw new _t(44);if(8192==(61440&c.mode)&&(r&=-513),65536&r&&16384!=(61440&c.mode))throw new _t(54);if(!_&&(n=c?40960==(61440&c.mode)?32:16384==(61440&c.mode)&&("r"!==ht(r)||512&r)?31:dt(c,ht(r)):44))throw new _t(n);if(512&r){var a;if(!(a="string"==typeof(n=c)?at(n,{Dc:!0}).node:n).dc.jc)throw new _t(63);if(16384==(61440&a.mode))throw new _t(31);if(32768!=(61440&a.mode))throw new _t(28);if(n=dt(a,"w"))throw new _t(n);a.dc.jc(a,{size:0,timestamp:Date.now()})}r&=-641,(s=vt({node:c,path:ot(c),flags:r,seekable:!0,position:0,ec:c.ec,Uc:[],error:!1},s)).ec.open&&s.ec.open(s),!e.logReadFiles||1&r||(St||(St={}),t in St||(St[t]=1,i("FS.trackingDelegate error on read file: "+t)));try{st.onOpenFile&&(c=0,1!=(2097155&r)&&(c|=1),0!=(2097155&r)&&(c|=2),st.onOpenFile(t,c))}catch(e){i("FS.trackingDelegate['onOpenFile']('"+t+"', flags) threw an exception: "+e.message)}return s}function Nt(t,e,r){if(null===t.lc)throw new _t(8);if(!t.seekable||!t.ec.oc)throw new _t(70);if(0!=r&&1!=r&&2!=r)throw new _t(28);t.position=t.ec.oc(t,e,r),t.Uc=[]}function It(){_t||((_t=function(t,e){this.node=e,this.Tc=function(t){this.nc=t},this.Tc(t),this.message="FS error"}).prototype=Error(),_t.prototype.constructor=_t,[44].forEach((function(t){ct[t]=new _t(t),ct[t].stack="<generic error, no stack>"})))}function Tt(t,e,r){t=U("/dev/"+t);var n=function(t,e){var r=0;return t&&(r|=365),e&&(r|=146),r}(!!e,!!r);Rt||(Rt=64);var s=Rt++<<8|0;wt(s,{open:function(t){t.seekable=!1},close:function(){r&&r.buffer&&r.buffer.length&&r(10)},read:function(t,r,n,s){for(var _=0,c=0;c<s;c++){try{var a=e()}catch(t){throw new _t(29)}if(void 0===a&&0===_)throw new _t(6);if(null==a)break;_++,r[n+c]=a}return _&&(t.node.timestamp=Date.now()),_},write:function(t,e,n,s){for(var _=0;_<s;_++)try{r(e[n+_])}catch(t){throw new _t(29)}return s&&(t.node.timestamp=Date.now()),_}}),xt(t,n,s)}var Rt,kt,St,Ft={},Lt=void 0;function zt(){return p[(Lt+=4)-4>>2]}function Mt(t){if(!(t=tt[t]))throw new _t(8);return t}function Dt(t,e,r,n){t||(t=this),this.parent=t,this.kc=t.kc,this.tc=null,this.id=et++,this.name=e,this.mode=r,this.dc={},this.ec={},this.uc=n}Object.defineProperties(Dt.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(t){t?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(t){t?this.mode|=146:this.mode&=-147}}}),It(),rt=Array(4096),gt(q,"/"),Et("/tmp"),Et("/home"),Et("/home/web_user"),function(){if(Et("/dev"),wt(259,{read:function(){return 0},write:function(t,e,r,n){return n}}),xt("/dev/null",259),j(1280,Z),j(1536,X),xt("/dev/tty",1280),xt("/dev/tty1",1536),"object"==typeof crypto&&"function"==typeof crypto.getRandomValues)var t=new Uint8Array(1),e=function(){return crypto.getRandomValues(t),t[0]};e||(e=function(){L("random_device")}),Tt("random",e),Tt("urandom",e),Et("/dev/shm"),Et("/dev/shm/tmp")}(),Et("/proc"),Et("/proc/self"),Et("/proc/self/fd"),gt({kc:function(){var t=lt("/proc/self","fd",16895,73);return t.dc={qc:function(t,e){var r=tt[+e];if(!r)throw new _t(8);return(t={parent:null,kc:{Hc:"fake"},dc:{rc:function(){return r.path}}}).parent=t}},t}},"/proc/self/fd");var Kt={b:function(t,r,n){Lt=n;try{var s=Mt(t);switch(r){case 0:var _=zt();return 0>_?-28:Ct(s.path,s.flags,0,_).lc;case 1:case 2:return 0;case 3:return s.flags;case 4:return _=zt(),s.flags|=_,0;case 12:return _=zt(),d[_+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-28;case 9:return e.___errno_location&&(p[e.___errno_location()>>2]=28),-1;default:return-28}}catch(t){return void 0!==Ft&&t instanceof _t||L(t),-t.nc}},h:function(t,e,r){Lt=r;try{return Ct(t?w(h,t,void 0):"",e,zt()).lc}catch(t){return void 0!==Ft&&t instanceof _t||L(t),-t.nc}},g:function(t,e,r){Lt=r;try{var n=Mt(t);switch(e){case 21509:case 21505:return n.gc?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.gc?0:-59;case 21519:if(!n.gc)return-59;var s=zt();return p[s>>2]=0;case 21520:return n.gc?-28:-59;case 21531:if(t=s=zt(),!n.ec.Pc)throw new _t(59);return n.ec.Pc(n,e,t);case 21523:case 21524:return n.gc?0:-59;default:L("bad ioctl syscall "+e)}}catch(t){return void 0!==Ft&&t instanceof _t||L(t),-t.nc}},a:function(){L()},j:function(t,e,r){h.copyWithin(t,e,e+r)},k:function(t){var e=h.length;if(2147418112<t)return!1;for(var r=1;4>=r;r*=2){var n=e*(1+.2/r);n=Math.min(n,t+100663296),0<(n=Math.max(16777216,t,n))%65536&&(n+=65536-n%65536);t:{try{u.grow(Math.min(2147418112,n)-l.byteLength+65535>>16),g(u.buffer);var s=1;break t}catch(t){}s=void 0}if(s)return!0}return!1},e:function(t){try{var e=Mt(t);if(null===e.lc)throw new _t(8);e.xc&&(e.xc=null);try{e.ec.close&&e.ec.close(e)}catch(t){throw t}finally{tt[e.lc]=null}return e.lc=null,0}catch(t){return void 0!==Ft&&t instanceof _t||L(t),t.nc}},f:function(t,e,r,n){try{t:{for(var s=Mt(t),_=t=0;_<r;_++){var c=p[e+(8*_+4)>>2],a=s,o=p[e+8*_>>2],i=c,u=void 0,l=f;if(0>i||0>u)throw new _t(28);if(null===a.lc)throw new _t(8);if(1==(2097155&a.flags))throw new _t(8);if(16384==(61440&a.node.mode))throw new _t(31);if(!a.ec.read)throw new _t(28);var h=void 0!==u;if(h){if(!a.seekable)throw new _t(70)}else u=a.position;var d=a.ec.read(a,l,o,i,u);h||(a.position+=d);var v=d;if(0>v){var m=-1;break t}if(t+=v,v<c)break}m=t}return p[n>>2]=m,0}catch(t){return void 0!==Ft&&t instanceof _t||L(t),t.nc}},i:function(t,e,r,n,s){try{var _=Mt(t);return-9007199254740992>=(t=4294967296*r+(e>>>0))||9007199254740992<=t?-61:(Nt(_,t,n),D=[_.position>>>0,(M=_.position,1<=+I(M)?0<M?(0|k(+R(M/4294967296),4294967295))>>>0:~~+T((M-+(~~M>>>0))/4294967296)>>>0:0)],p[s>>2]=D[0],p[s+4>>2]=D[1],_.xc&&0===t&&0===n&&(_.xc=null),0)}catch(t){return void 0!==Ft&&t instanceof _t||L(t),t.nc}},d:function(t,e,r,n){try{t:{for(var s=Mt(t),_=t=0;_<r;_++){var c=s,a=p[e+8*_>>2],o=p[e+(8*_+4)>>2],u=void 0,l=f;if(0>o||0>u)throw new _t(28);if(null===c.lc)throw new _t(8);if(0==(2097155&c.flags))throw new _t(8);if(16384==(61440&c.node.mode))throw new _t(31);if(!c.ec.write)throw new _t(28);1024&c.flags&&Nt(c,0,2);var h=void 0!==u;if(h){if(!c.seekable)throw new _t(70)}else u=c.position;var d=c.ec.write(c,l,a,o,u,void 0);h||(c.position+=d);try{c.path&&st.onWriteToFile&&st.onWriteToFile(c.path)}catch(t){i("FS.trackingDelegate['onWriteToFile']('"+c.path+"') threw an exception: "+t.message)}var v=d;if(0>v){var m=-1;break t}t+=v}m=t}return p[n>>2]=m,0}catch(t){return void 0!==Ft&&t instanceof _t||L(t),t.nc}},c:function(t){var e=Date.now();return p[t>>2]=e/1e3|0,p[t+4>>2]=e%1e3*1e3|0,0},memory:u,table:v},Ot=function(){function t(t){e.asm=t.exports,S--,e.monitorRunDependencies&&e.monitorRunDependencies(S),0==S&&F&&(t=F,F=null,t())}function r(e){t(e.instance)}function n(t){return(a||"function"!=typeof fetch?new Promise((function(t){t(B())})):fetch(K,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+K+"'";return t.arrayBuffer()})).catch((function(){return B()}))).then((function(t){return WebAssembly.instantiate(t,s)})).then(t,(function(t){i("failed to asynchronously prepare wasm: "+t),L(t)}))}var s={a:Kt};if(S++,e.monitorRunDependencies&&e.monitorRunDependencies(S),e.instantiateWasm)try{return e.instantiateWasm(s,t)}catch(t){return i("Module.instantiateWasm callback failed with error: "+t),!1}return function(){if(a||"function"!=typeof WebAssembly.instantiateStreaming||z()||"function"!=typeof fetch)return n(r);fetch(K,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,s).then(r,(function(t){i("wasm streaming compile failed: "+t),i("falling back to ArrayBuffer instantiation"),n(r)}))}))}(),{}}();e.asm=Ot;var Bt=e.___wasm_call_ctors=function(){return(Bt=e.___wasm_call_ctors=e.asm.l).apply(null,arguments)};e._vscr_error_ctx_size=function(){return(e._vscr_error_ctx_size=e.asm.m).apply(null,arguments)},e._vscr_error_reset=function(){return(e._vscr_error_reset=e.asm.n).apply(null,arguments)},e._vscr_error_status=function(){return(e._vscr_error_status=e.asm.o).apply(null,arguments)},e._vscr_ratchet_group_message_new=function(){return(e._vscr_ratchet_group_message_new=e.asm.p).apply(null,arguments)},e._vscr_ratchet_group_message_delete=function(){return(e._vscr_ratchet_group_message_delete=e.asm.q).apply(null,arguments)},e._vscr_ratchet_group_message_shallow_copy=function(){return(e._vscr_ratchet_group_message_shallow_copy=e.asm.r).apply(null,arguments)},e._vscr_ratchet_group_message_get_type=function(){return(e._vscr_ratchet_group_message_get_type=e.asm.s).apply(null,arguments)},e._vscr_ratchet_group_message_get_session_id=function(){return(e._vscr_ratchet_group_message_get_session_id=e.asm.t).apply(null,arguments)},e._vscr_ratchet_group_message_get_counter=function(){return(e._vscr_ratchet_group_message_get_counter=e.asm.u).apply(null,arguments)},e._vscr_ratchet_group_message_get_epoch=function(){return(e._vscr_ratchet_group_message_get_epoch=e.asm.v).apply(null,arguments)},e._vscr_ratchet_group_message_serialize_len=function(){return(e._vscr_ratchet_group_message_serialize_len=e.asm.w).apply(null,arguments)},e._vscr_ratchet_group_message_serialize=function(){return(e._vscr_ratchet_group_message_serialize=e.asm.x).apply(null,arguments)},e._vscr_ratchet_group_message_deserialize=function(){return(e._vscr_ratchet_group_message_deserialize=e.asm.y).apply(null,arguments)},e._vscr_ratchet_group_participants_ids_new=function(){return(e._vscr_ratchet_group_participants_ids_new=e.asm.z).apply(null,arguments)},e._vscr_ratchet_group_participants_ids_new_size=function(){return(e._vscr_ratchet_group_participants_ids_new_size=e.asm.A).apply(null,arguments)},e._vscr_ratchet_group_participants_ids_delete=function(){return(e._vscr_ratchet_group_participants_ids_delete=e.asm.B).apply(null,arguments)},e._vscr_ratchet_group_participants_ids_shallow_copy=function(){return(e._vscr_ratchet_group_participants_ids_shallow_copy=e.asm.C).apply(null,arguments)},e._vscr_ratchet_group_participants_ids_add_id=function(){return(e._vscr_ratchet_group_participants_ids_add_id=e.asm.D).apply(null,arguments)},e._vscr_ratchet_group_participants_info_new=function(){return(e._vscr_ratchet_group_participants_info_new=e.asm.E).apply(null,arguments)},e._vscr_ratchet_group_participants_info_new_size=function(){return(e._vscr_ratchet_group_participants_info_new_size=e.asm.F).apply(null,arguments)},e._vscr_ratchet_group_participants_info_delete=function(){return(e._vscr_ratchet_group_participants_info_delete=e.asm.G).apply(null,arguments)},e._vscr_ratchet_group_participants_info_shallow_copy=function(){return(e._vscr_ratchet_group_participants_info_shallow_copy=e.asm.H).apply(null,arguments)},e._vscr_ratchet_group_participants_info_add_participant=function(){return(e._vscr_ratchet_group_participants_info_add_participant=e.asm.I).apply(null,arguments)},e._vscr_ratchet_group_session_release_rng=function(){return(e._vscr_ratchet_group_session_release_rng=e.asm.J).apply(null,arguments)},e._vscr_ratchet_group_session_new=function(){return(e._vscr_ratchet_group_session_new=e.asm.K).apply(null,arguments)},e._vscr_ratchet_group_session_delete=function(){return(e._vscr_ratchet_group_session_delete=e.asm.L).apply(null,arguments)},e._vscr_ratchet_group_session_shallow_copy=function(){return(e._vscr_ratchet_group_session_shallow_copy=e.asm.M).apply(null,arguments)},e._vscr_ratchet_group_session_use_rng=function(){return(e._vscr_ratchet_group_session_use_rng=e.asm.N).apply(null,arguments)},e._vscr_ratchet_group_session_is_initialized=function(){return(e._vscr_ratchet_group_session_is_initialized=e.asm.O).apply(null,arguments)},e._vscr_ratchet_group_session_is_private_key_set=function(){return(e._vscr_ratchet_group_session_is_private_key_set=e.asm.P).apply(null,arguments)},e._vscr_ratchet_group_session_is_my_id_set=function(){return(e._vscr_ratchet_group_session_is_my_id_set=e.asm.Q).apply(null,arguments)},e._vscr_ratchet_group_session_get_current_epoch=function(){return(e._vscr_ratchet_group_session_get_current_epoch=e.asm.R).apply(null,arguments)},e._vscr_ratchet_group_session_setup_defaults=function(){return(e._vscr_ratchet_group_session_setup_defaults=e.asm.S).apply(null,arguments)},e._vscr_ratchet_group_session_set_private_key=function(){return(e._vscr_ratchet_group_session_set_private_key=e.asm.T).apply(null,arguments)},e._vscr_ratchet_group_session_set_my_id=function(){return(e._vscr_ratchet_group_session_set_my_id=e.asm.U).apply(null,arguments)},e._vscr_ratchet_group_session_get_my_id=function(){return(e._vscr_ratchet_group_session_get_my_id=e.asm.V).apply(null,arguments)},e._vscr_ratchet_group_session_get_session_id=function(){return(e._vscr_ratchet_group_session_get_session_id=e.asm.W).apply(null,arguments)},e._vscr_ratchet_group_session_get_participants_count=function(){return(e._vscr_ratchet_group_session_get_participants_count=e.asm.X).apply(null,arguments)},e._vscr_ratchet_group_session_setup_session_state=function(){return(e._vscr_ratchet_group_session_setup_session_state=e.asm.Y).apply(null,arguments)},e._vscr_ratchet_group_session_update_session_state=function(){return(e._vscr_ratchet_group_session_update_session_state=e.asm.Z).apply(null,arguments)},e._vscr_ratchet_group_session_encrypt=function(){return(e._vscr_ratchet_group_session_encrypt=e.asm._).apply(null,arguments)},e._vscr_ratchet_group_session_decrypt_len=function(){return(e._vscr_ratchet_group_session_decrypt_len=e.asm.$).apply(null,arguments)},e._vscr_ratchet_group_session_decrypt=function(){return(e._vscr_ratchet_group_session_decrypt=e.asm.aa).apply(null,arguments)},e._vscr_ratchet_group_session_serialize=function(){return(e._vscr_ratchet_group_session_serialize=e.asm.ba).apply(null,arguments)},e._vscr_ratchet_group_session_deserialize=function(){return(e._vscr_ratchet_group_session_deserialize=e.asm.ca).apply(null,arguments)},e._vscr_ratchet_group_session_create_group_ticket=function(){return(e._vscr_ratchet_group_session_create_group_ticket=e.asm.da).apply(null,arguments)},e._vscr_ratchet_group_ticket_release_rng=function(){return(e._vscr_ratchet_group_ticket_release_rng=e.asm.ea).apply(null,arguments)},e._vscr_ratchet_group_ticket_new=function(){return(e._vscr_ratchet_group_ticket_new=e.asm.fa).apply(null,arguments)},e._vscr_ratchet_group_ticket_delete=function(){return(e._vscr_ratchet_group_ticket_delete=e.asm.ga).apply(null,arguments)},e._vscr_ratchet_group_ticket_shallow_copy=function(){return(e._vscr_ratchet_group_ticket_shallow_copy=e.asm.ha).apply(null,arguments)},e._vscr_ratchet_group_ticket_use_rng=function(){return(e._vscr_ratchet_group_ticket_use_rng=e.asm.ia).apply(null,arguments)},e._vscr_ratchet_group_ticket_setup_defaults=function(){return(e._vscr_ratchet_group_ticket_setup_defaults=e.asm.ja).apply(null,arguments)},e._vscr_ratchet_group_ticket_setup_ticket_as_new=function(){return(e._vscr_ratchet_group_ticket_setup_ticket_as_new=e.asm.ka).apply(null,arguments)},e._vscr_ratchet_group_ticket_get_ticket_message=function(){return(e._vscr_ratchet_group_ticket_get_ticket_message=e.asm.la).apply(null,arguments)},e._vscr_ratchet_key_id_new=function(){return(e._vscr_ratchet_key_id_new=e.asm.ma).apply(null,arguments)},e._vscr_ratchet_key_id_delete=function(){return(e._vscr_ratchet_key_id_delete=e.asm.na).apply(null,arguments)},e._vscr_ratchet_key_id_shallow_copy=function(){return(e._vscr_ratchet_key_id_shallow_copy=e.asm.oa).apply(null,arguments)},e._vscr_ratchet_key_id_compute_public_key_id=function(){return(e._vscr_ratchet_key_id_compute_public_key_id=e.asm.pa).apply(null,arguments)},e._vscr_ratchet_message_new=function(){return(e._vscr_ratchet_message_new=e.asm.qa).apply(null,arguments)},e._vscr_ratchet_message_delete=function(){return(e._vscr_ratchet_message_delete=e.asm.ra).apply(null,arguments)},e._vscr_ratchet_message_shallow_copy=function(){return(e._vscr_ratchet_message_shallow_copy=e.asm.sa).apply(null,arguments)},e._vscr_ratchet_message_get_type=function(){return(e._vscr_ratchet_message_get_type=e.asm.ta).apply(null,arguments)},e._vscr_ratchet_message_get_counter=function(){return(e._vscr_ratchet_message_get_counter=e.asm.ua).apply(null,arguments)},e._vscr_ratchet_message_get_long_term_public_key=function(){return(e._vscr_ratchet_message_get_long_term_public_key=e.asm.va).apply(null,arguments)},e._vscr_ratchet_message_get_one_time_public_key=function(){return(e._vscr_ratchet_message_get_one_time_public_key=e.asm.wa).apply(null,arguments)},e._vscr_ratchet_message_serialize_len=function(){return(e._vscr_ratchet_message_serialize_len=e.asm.xa).apply(null,arguments)},e._vscr_ratchet_message_serialize=function(){return(e._vscr_ratchet_message_serialize=e.asm.ya).apply(null,arguments)},e._vscr_ratchet_message_deserialize=function(){return(e._vscr_ratchet_message_deserialize=e.asm.za).apply(null,arguments)},e._vscr_ratchet_session_release_rng=function(){return(e._vscr_ratchet_session_release_rng=e.asm.Aa).apply(null,arguments)},e._vscr_ratchet_session_new=function(){return(e._vscr_ratchet_session_new=e.asm.Ba).apply(null,arguments)},e._vscr_ratchet_session_delete=function(){return(e._vscr_ratchet_session_delete=e.asm.Ca).apply(null,arguments)},e._vscr_ratchet_session_shallow_copy=function(){return(e._vscr_ratchet_session_shallow_copy=e.asm.Da).apply(null,arguments)},e._vscr_ratchet_session_use_rng=function(){return(e._vscr_ratchet_session_use_rng=e.asm.Ea).apply(null,arguments)},e._vscr_ratchet_session_setup_defaults=function(){return(e._vscr_ratchet_session_setup_defaults=e.asm.Fa).apply(null,arguments)},e._vscr_ratchet_session_initiate=function(){return(e._vscr_ratchet_session_initiate=e.asm.Ga).apply(null,arguments)},e._vscr_ratchet_session_respond=function(){return(e._vscr_ratchet_session_respond=e.asm.Ha).apply(null,arguments)},e._vscr_ratchet_session_is_initiator=function(){return(e._vscr_ratchet_session_is_initiator=e.asm.Ia).apply(null,arguments)},e._vscr_ratchet_session_received_first_response=function(){return(e._vscr_ratchet_session_received_first_response=e.asm.Ja).apply(null,arguments)},e._vscr_ratchet_session_receiver_has_one_time_public_key=function(){return(e._vscr_ratchet_session_receiver_has_one_time_public_key=e.asm.Ka).apply(null,arguments)},e._vscr_ratchet_session_encrypt=function(){return(e._vscr_ratchet_session_encrypt=e.asm.La).apply(null,arguments)},e._vscr_ratchet_session_decrypt_len=function(){return(e._vscr_ratchet_session_decrypt_len=e.asm.Ma).apply(null,arguments)},e._vscr_ratchet_session_decrypt=function(){return(e._vscr_ratchet_session_decrypt=e.asm.Na).apply(null,arguments)},e._vscr_ratchet_session_serialize=function(){return(e._vscr_ratchet_session_serialize=e.asm.Oa).apply(null,arguments)},e._vscr_ratchet_session_deserialize=function(){return(e._vscr_ratchet_session_deserialize=e.asm.Pa).apply(null,arguments)},e._vscf_impl_api=function(){return(e._vscf_impl_api=e.asm.Qa).apply(null,arguments)},e._vscf_impl_tag=function(){return(e._vscf_impl_tag=e.asm.Ra).apply(null,arguments)},e._vscf_impl_shallow_copy=function(){return(e._vscf_impl_shallow_copy=e.asm.Sa).apply(null,arguments)},e._vscf_ctr_drbg_setup_defaults=function(){return(e._vscf_ctr_drbg_setup_defaults=e.asm.Ta).apply(null,arguments)},e._vscf_ctr_drbg_enable_prediction_resistance=function(){return(e._vscf_ctr_drbg_enable_prediction_resistance=e.asm.Ua).apply(null,arguments)},e._vscf_ctr_drbg_set_reseed_interval=function(){return(e._vscf_ctr_drbg_set_reseed_interval=e.asm.Va).apply(null,arguments)},e._vscf_ctr_drbg_set_entropy_len=function(){return(e._vscf_ctr_drbg_set_entropy_len=e.asm.Wa).apply(null,arguments)},e._vscf_ctr_drbg_random=function(){return(e._vscf_ctr_drbg_random=e.asm.Xa).apply(null,arguments)},e._vscf_ctr_drbg_reseed=function(){return(e._vscf_ctr_drbg_reseed=e.asm.Ya).apply(null,arguments)},e._vscf_ctr_drbg_release_entropy_source=function(){return(e._vscf_ctr_drbg_release_entropy_source=e.asm.Za).apply(null,arguments)},e._vscf_ctr_drbg_new=function(){return(e._vscf_ctr_drbg_new=e.asm._a).apply(null,arguments)},e._vscf_ctr_drbg_delete=function(){return(e._vscf_ctr_drbg_delete=e.asm.$a).apply(null,arguments)},e._vscf_ctr_drbg_shallow_copy=function(){return(e._vscf_ctr_drbg_shallow_copy=e.asm.ab).apply(null,arguments)},e._vscf_ctr_drbg_use_entropy_source=function(){return(e._vscf_ctr_drbg_use_entropy_source=e.asm.bb).apply(null,arguments)},e._vscf_hkdf_alg_id=function(){return(e._vscf_hkdf_alg_id=e.asm.cb).apply(null,arguments)},e._vscf_hkdf_produce_alg_info=function(){return(e._vscf_hkdf_produce_alg_info=e.asm.db).apply(null,arguments)},e._vscf_hkdf_restore_alg_info=function(){return(e._vscf_hkdf_restore_alg_info=e.asm.eb).apply(null,arguments)},e._vscf_hkdf_derive=function(){return(e._vscf_hkdf_derive=e.asm.fb).apply(null,arguments)},e._vscf_hkdf_reset=function(){return(e._vscf_hkdf_reset=e.asm.gb).apply(null,arguments)},e._vscf_hkdf_set_info=function(){return(e._vscf_hkdf_set_info=e.asm.hb).apply(null,arguments)},e._vscf_hkdf_release_hash=function(){return(e._vscf_hkdf_release_hash=e.asm.ib).apply(null,arguments)},e._vscf_hkdf_new=function(){return(e._vscf_hkdf_new=e.asm.jb).apply(null,arguments)},e._vscf_hkdf_delete=function(){return(e._vscf_hkdf_delete=e.asm.kb).apply(null,arguments)},e._vscf_hkdf_shallow_copy=function(){return(e._vscf_hkdf_shallow_copy=e.asm.lb).apply(null,arguments)},e._vscf_hkdf_use_hash=function(){return(e._vscf_hkdf_use_hash=e.asm.mb).apply(null,arguments)},e._vscf_hmac_alg_id=function(){return(e._vscf_hmac_alg_id=e.asm.nb).apply(null,arguments)},e._vscf_hmac_produce_alg_info=function(){return(e._vscf_hmac_produce_alg_info=e.asm.ob).apply(null,arguments)},e._vscf_hmac_restore_alg_info=function(){return(e._vscf_hmac_restore_alg_info=e.asm.pb).apply(null,arguments)},e._vscf_hmac_digest_len=function(){return(e._vscf_hmac_digest_len=e.asm.qb).apply(null,arguments)},e._vscf_hmac_mac=function(){return(e._vscf_hmac_mac=e.asm.rb).apply(null,arguments)},e._vscf_hmac_start=function(){return(e._vscf_hmac_start=e.asm.sb).apply(null,arguments)},e._vscf_hmac_finish=function(){return(e._vscf_hmac_finish=e.asm.tb).apply(null,arguments)},e._vscf_hmac_update=function(){return(e._vscf_hmac_update=e.asm.ub).apply(null,arguments)},e._vscf_hmac_reset=function(){return(e._vscf_hmac_reset=e.asm.vb).apply(null,arguments)},e._vscf_hmac_release_hash=function(){return(e._vscf_hmac_release_hash=e.asm.wb).apply(null,arguments)},e._vscf_hmac_new=function(){return(e._vscf_hmac_new=e.asm.xb).apply(null,arguments)},e._vscf_hmac_delete=function(){return(e._vscf_hmac_delete=e.asm.yb).apply(null,arguments)},e._vscf_hmac_shallow_copy=function(){return(e._vscf_hmac_shallow_copy=e.asm.zb).apply(null,arguments)},e._vscf_hmac_use_hash=function(){return(e._vscf_hmac_use_hash=e.asm.Ab).apply(null,arguments)},e._vscf_sha512_alg_id=function(){return(e._vscf_sha512_alg_id=e.asm.Bb).apply(null,arguments)},e._vscf_sha512_produce_alg_info=function(){return(e._vscf_sha512_produce_alg_info=e.asm.Cb).apply(null,arguments)},e._vscf_sha512_restore_alg_info=function(){return(e._vscf_sha512_restore_alg_info=e.asm.Db).apply(null,arguments)},e._vscf_sha512_hash=function(){return(e._vscf_sha512_hash=e.asm.Eb).apply(null,arguments)},e._vscf_sha512_finish=function(){return(e._vscf_sha512_finish=e.asm.Fb).apply(null,arguments)},e._vscf_sha512_start=function(){return(e._vscf_sha512_start=e.asm.Gb).apply(null,arguments)},e._vscf_sha512_update=function(){return(e._vscf_sha512_update=e.asm.Hb).apply(null,arguments)},e._vscf_sha512_new=function(){return(e._vscf_sha512_new=e.asm.Ib).apply(null,arguments)},e._vscf_sha512_delete=function(){return(e._vscf_sha512_delete=e.asm.Jb).apply(null,arguments)},e._vscf_sha512_shallow_copy=function(){return(e._vscf_sha512_shallow_copy=e.asm.Kb).apply(null,arguments)},e._vscf_error_ctx_size=function(){return(e._vscf_error_ctx_size=e.asm.Lb).apply(null,arguments)},e._vscf_error_reset=function(){return(e._vscf_error_reset=e.asm.Mb).apply(null,arguments)},e._vscf_error_status=function(){return(e._vscf_error_status=e.asm.Nb).apply(null,arguments)},e._vsc_buffer_new=function(){return(e._vsc_buffer_new=e.asm.Ob).apply(null,arguments)},e._vsc_buffer_new_with_capacity=function(){return(e._vsc_buffer_new_with_capacity=e.asm.Pb).apply(null,arguments)},e._vsc_buffer_delete=function(){return(e._vsc_buffer_delete=e.asm.Qb).apply(null,arguments)},e._vsc_buffer_data=function(){return(e._vsc_buffer_data=e.asm.Rb).apply(null,arguments)},e._vsc_buffer_make_secure=function(){return(e._vsc_buffer_make_secure=e.asm.Sb).apply(null,arguments)},e._vsc_buffer_bytes=function(){return(e._vsc_buffer_bytes=e.asm.Tb).apply(null,arguments)},e._vsc_buffer_len=function(){return(e._vsc_buffer_len=e.asm.Ub).apply(null,arguments)},e._vsc_data_ctx_size=function(){return(e._vsc_data_ctx_size=e.asm.Vb).apply(null,arguments)},e._vsc_data=function(){return(e._vsc_data=e.asm.Wb).apply(null,arguments)},e._vsc_data_len=function(){return(e._vsc_data_len=e.asm.Xb).apply(null,arguments)},e._vsc_data_bytes=function(){return(e._vsc_data_bytes=e.asm.Yb).apply(null,arguments)},e.___errno_location=function(){return(e.___errno_location=e.asm.Zb).apply(null,arguments)};var Ht,Ut=e._malloc=function(){return(Ut=e._malloc=e.asm._b).apply(null,arguments)};function Yt(){function t(){if(!Ht&&(Ht=!0,e.calledRun=!0,!m)){if(e.noFSInit||mt||(mt=!0,It(),e.stdin=e.stdin,e.stdout=e.stdout,e.stderr=e.stderr,e.stdin?Tt("stdin",e.stdin):At("/dev/tty","/dev/stdin"),e.stdout?Tt("stdout",null,e.stdout):At("/dev/tty","/dev/stdout"),e.stderr?Tt("stderr",null,e.stderr):At("/dev/tty1","/dev/stderr"),Ct("/dev/stdin","r"),Ct("/dev/stdout","w"),Ct("/dev/stderr","w")),E(A),nt=!1,E(b),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;){var t=e.postRun.shift();C.unshift(t)}E(C)}}if(!(0<S)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)N();E(x),0<S||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),t()}),1)):t())}}if(e._free=function(){return(e._free=e.asm.$b).apply(null,arguments)},e.stackAlloc=function(){return(e.stackAlloc=e.asm.ac).apply(null,arguments)},e.dynCall_vi=function(){return(e.dynCall_vi=e.asm.bc).apply(null,arguments)},e.asm=Ot,e.then=function(t){if(Ht)t(e);else{var r=e.onRuntimeInitialized;e.onRuntimeInitialized=function(){r&&r(),t(e)}}return e},F=function t(){Ht||Yt(),Ht||(F=t)},e.run=Yt,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return Yt(),t});t.exports=n}));var e=(t,e)=>{class r extends Error{constructor(t){super(t),this.name="FoundationError",this.message=t}static handleStatusCode(t){if(0!=t){if(-1==t)throw new r("This error should not be returned if assertions is enabled.");if(-2==t)throw new r("Can be used to define that not all context prerequisites are satisfied. Note, this error should not be returned if assertions is enabled.");if(-3==t)throw new r("Define that error code from one of third-party module was not handled. Note, this error should not be returned if assertions is enabled.");if(-101==t)throw new r("Buffer capacity is not enough to hold result.");if(-200==t)throw new r("Unsupported algorithm.");if(-201==t)throw new r("Authentication failed during decryption.");if(-202==t)throw new r("Attempt to read data out of buffer bounds.");if(-203==t)throw new r("ASN.1 encoded data is corrupted.");if(-204==t)throw new r("Attempt to read ASN.1 type that is bigger then requested C type.");if(-205==t)throw new r("ASN.1 representation of PKCS#1 public key is corrupted.");if(-206==t)throw new r("ASN.1 representation of PKCS#1 private key is corrupted.");if(-207==t)throw new r("ASN.1 representation of PKCS#8 public key is corrupted.");if(-208==t)throw new r("ASN.1 representation of PKCS#8 private key is corrupted.");if(-209==t)throw new r("Encrypted data is corrupted.");if(-210==t)throw new r("Underlying random operation returns error.");if(-211==t)throw new r("Generation of the private or secret key failed.");if(-212==t)throw new r("One of the entropy sources failed.");if(-213==t)throw new r("Requested data to be generated is too big.");if(-214==t)throw new r("Base64 encoded string contains invalid characters.");if(-215==t)throw new r("PEM data is corrupted.");if(-216==t)throw new r("Exchange key return zero.");if(-217==t)throw new r("Ed25519 public key is corrupted.");if(-218==t)throw new r("Ed25519 private key is corrupted.");if(-219==t)throw new r("CURVE25519 public key is corrupted.");if(-220==t)throw new r("CURVE25519 private key is corrupted.");if(-221==t)throw new r("Elliptic curve public key format is corrupted see RFC 5480.");if(-222==t)throw new r("Elliptic curve public key format is corrupted see RFC 5915.");if(-223==t)throw new r("ASN.1 representation of a public key is corrupted.");if(-224==t)throw new r("ASN.1 representation of a private key is corrupted.");if(-225==t)throw new r("Key algorithm does not accept given type of public key.");if(-226==t)throw new r("Key algorithm does not accept given type of private key.");if(-227==t)throw new r("Post-quantum Falcon-Sign public key is corrupted.");if(-228==t)throw new r("Post-quantum Falcon-Sign private key is corrupted.");if(-229==t)throw new r("Generic Round5 library error.");if(-230==t)throw new r("Post-quantum NIST Round5 public key is corrupted.");if(-231==t)throw new r("Post-quantum NIST Round5 private key is corrupted.");if(-232==t)throw new r("Compound public key is corrupted.");if(-233==t)throw new r("Compound private key is corrupted.");if(-234==t)throw new r("Compound public hybrid key is corrupted.");if(-235==t)throw new r("Compound private hybrid key is corrupted.");if(-236==t)throw new r("ASN.1 AlgorithmIdentifer is corrupted.");if(-237==t)throw new r("ASN.1 AlgorithmIdentifer with ECParameters is corrupted.");if(-238==t)throw new r("ASN.1 AlgorithmIdentifer with CompoundKeyParams is corrupted.");if(-239==t)throw new r("ASN.1 AlgorithmIdentifer with HybridKeyParams is corrupted.");if(-301==t)throw new r("Decryption failed, because message info was not given explicitly, and was not part of an encrypted message.");if(-302==t)throw new r("Message Info is corrupted.");if(-303==t)throw new r("Recipient defined with id is not found within message info during data decryption.");if(-304==t)throw new r("Content encryption key can not be decrypted with a given private key.");if(-305==t)throw new r("Content encryption key can not be decrypted with a given password.");if(-306==t)throw new r("Custom parameter with a given key is not found within message info.");if(-307==t)throw new r("A custom parameter with a given key is found, but the requested value type does not correspond to the actual type.");if(-308==t)throw new r("Signature format is corrupted.");if(-309==t)throw new r("Message Info footer is corrupted.");if(-401==t)throw new r("Brainkey password length is out of range.");if(-402==t)throw new r("Brainkey number length should be 32 byte.");if(-403==t)throw new r("Brainkey point length should be 65 bytes.");if(-404==t)throw new r("Brainkey name is out of range.");if(-405==t)throw new r("Brainkey internal error.");if(-406==t)throw new r("Brainkey point is invalid.");if(-407==t)throw new r("Brainkey number buffer length capacity should be >= 32 byte.");if(-408==t)throw new r("Brainkey point buffer length capacity should be >= 32 byte.");if(-409==t)throw new r("Brainkey seed buffer length capacity should be >= 32 byte.");if(-410==t)throw new r("Brainkey identity secret is invalid.");if(-411==t)throw new r("KEM encapsulated key is invalid or does not correspond to the private key.");if(-501==t)throw new r("Invalid padding.");if(-601==t)throw new r("Protobuf error.");if(-701==t)throw new r("Session id doesnt match.");if(-702==t)throw new r("Epoch not found.");if(-703==t)throw new r("Wrong key type.");if(-704==t)throw new r("Invalid signature.");if(-705==t)throw new r("Ed25519 error.");if(-706==t)throw new r("Duplicate epoch.");if(-707==t)throw new r("Plain text too long.");throw new r("Unexpected status code:"+t)}}}return r};var r=(t,e)=>class{static newAndTakeCContext(r){const n=t._vscf_impl_tag(r);switch(n){case e.FoundationImplTag.SHA224:return e.Sha224.newAndTakeCContext(r);case e.FoundationImplTag.SHA256:return e.Sha256.newAndTakeCContext(r);case e.FoundationImplTag.SHA384:return e.Sha384.newAndTakeCContext(r);case e.FoundationImplTag.SHA512:return e.Sha512.newAndTakeCContext(r);case e.FoundationImplTag.AES256_GCM:return e.Aes256Gcm.newAndTakeCContext(r);case e.FoundationImplTag.AES256_CBC:return e.Aes256Cbc.newAndTakeCContext(r);case e.FoundationImplTag.ASN1RD:return e.Asn1rd.newAndTakeCContext(r);case e.FoundationImplTag.ASN1WR:return e.Asn1wr.newAndTakeCContext(r);case e.FoundationImplTag.RSA_PUBLIC_KEY:return e.RsaPublicKey.newAndTakeCContext(r);case e.FoundationImplTag.RSA_PRIVATE_KEY:return e.RsaPrivateKey.newAndTakeCContext(r);case e.FoundationImplTag.RSA:return e.Rsa.newAndTakeCContext(r);case e.FoundationImplTag.ECC_PUBLIC_KEY:return e.EccPublicKey.newAndTakeCContext(r);case e.FoundationImplTag.ECC_PRIVATE_KEY:return e.EccPrivateKey.newAndTakeCContext(r);case e.FoundationImplTag.ECC:return e.Ecc.newAndTakeCContext(r);case e.FoundationImplTag.ENTROPY_ACCUMULATOR:return e.EntropyAccumulator.newAndTakeCContext(r);case e.FoundationImplTag.CTR_DRBG:return e.CtrDrbg.newAndTakeCContext(r);case e.FoundationImplTag.HMAC:return e.Hmac.newAndTakeCContext(r);case e.FoundationImplTag.HKDF:return e.Hkdf.newAndTakeCContext(r);case e.FoundationImplTag.KDF1:return e.Kdf1.newAndTakeCContext(r);case e.FoundationImplTag.KDF2:return e.Kdf2.newAndTakeCContext(r);case e.FoundationImplTag.FAKE_RANDOM:return e.FakeRandom.newAndTakeCContext(r);case e.FoundationImplTag.PKCS5_PBKDF2:return e.Pkcs5Pbkdf2.newAndTakeCContext(r);case e.FoundationImplTag.PKCS5_PBES2:return e.Pkcs5Pbes2.newAndTakeCContext(r);case e.FoundationImplTag.SEED_ENTROPY_SOURCE:return e.SeedEntropySource.newAndTakeCContext(r);case e.FoundationImplTag.KEY_MATERIAL_RNG:return e.KeyMaterialRng.newAndTakeCContext(r);case e.FoundationImplTag.RAW_PUBLIC_KEY:return e.RawPublicKey.newAndTakeCContext(r);case e.FoundationImplTag.RAW_PRIVATE_KEY:return e.RawPrivateKey.newAndTakeCContext(r);case e.FoundationImplTag.PKCS8_SERIALIZER:return e.Pkcs8Serializer.newAndTakeCContext(r);case e.FoundationImplTag.SEC1_SERIALIZER:return e.Sec1Serializer.newAndTakeCContext(r);case e.FoundationImplTag.KEY_ASN1_SERIALIZER:return e.KeyAsn1Serializer.newAndTakeCContext(r);case e.FoundationImplTag.KEY_ASN1_DESERIALIZER:return e.KeyAsn1Deserializer.newAndTakeCContext(r);case e.FoundationImplTag.ED25519:return e.Ed25519.newAndTakeCContext(r);case e.FoundationImplTag.CURVE25519:return e.Curve25519.newAndTakeCContext(r);case e.FoundationImplTag.FALCON:return e.Falcon.newAndTakeCContext(r);case e.FoundationImplTag.ROUND5:return e.Round5.newAndTakeCContext(r);case e.FoundationImplTag.COMPOUND_KEY_ALG_INFO:return e.CompoundKeyAlgInfo.newAndTakeCContext(r);case e.FoundationImplTag.COMPOUND_PUBLIC_KEY:return e.CompoundPublicKey.newAndTakeCContext(r);case e.FoundationImplTag.COMPOUND_PRIVATE_KEY:return e.CompoundPrivateKey.newAndTakeCContext(r);case e.FoundationImplTag.COMPOUND_KEY_ALG:return e.CompoundKeyAlg.newAndTakeCContext(r);case e.FoundationImplTag.HYBRID_KEY_ALG_INFO:return e.HybridKeyAlgInfo.newAndTakeCContext(r);case e.FoundationImplTag.HYBRID_PUBLIC_KEY:return e.HybridPublicKey.newAndTakeCContext(r);case e.FoundationImplTag.HYBRID_PRIVATE_KEY:return e.HybridPrivateKey.newAndTakeCContext(r);case e.FoundationImplTag.HYBRID_KEY_ALG:return e.HybridKeyAlg.newAndTakeCContext(r);case e.FoundationImplTag.SIMPLE_ALG_INFO:return e.SimpleAlgInfo.newAndTakeCContext(r);case e.FoundationImplTag.HASH_BASED_ALG_INFO:return e.HashBasedAlgInfo.newAndTakeCContext(r);case e.FoundationImplTag.CIPHER_ALG_INFO:return e.CipherAlgInfo.newAndTakeCContext(r);case e.FoundationImplTag.SALTED_KDF_ALG_INFO:return e.SaltedKdfAlgInfo.newAndTakeCContext(r);case e.FoundationImplTag.PBE_ALG_INFO:return e.PbeAlgInfo.newAndTakeCContext(r);case e.FoundationImplTag.ECC_ALG_INFO:return e.EccAlgInfo.newAndTakeCContext(r);case e.FoundationImplTag.ALG_INFO_DER_SERIALIZER:return e.AlgInfoDerSerializer.newAndTakeCContext(r);case e.FoundationImplTag.ALG_INFO_DER_DESERIALIZER:return e.AlgInfoDerDeserializer.newAndTakeCContext(r);case e.FoundationImplTag.MESSAGE_INFO_DER_SERIALIZER:return e.MessageInfoDerSerializer.newAndTakeCContext(r);case e.FoundationImplTag.RANDOM_PADDING:return e.RandomPadding.newAndTakeCContext(r);default:throw new Error("Unexpected implementation tag found: "+n)}}static newAndUseCContext(r){return new e.FoundationInterface.newAndTakeCContext(t._vscf_impl_shallow_copy(r))}static isImplemented(e,r){return 0!=t._vscf_impl_api(e,r)}};var n=(t,e)=>Object.freeze({ALG:1,ALG_INFO:2,ALG_INFO_DESERIALIZER:3,ALG_INFO_SERIALIZER:4,ASN1_READER:5,ASN1_WRITER:6,AUTH_DECRYPT:7,AUTH_ENCRYPT:8,CIPHER:9,CIPHER_AUTH:10,CIPHER_AUTH_INFO:11,CIPHER_INFO:12,COMPUTE_SHARED_KEY:13,DECRYPT:14,ENCRYPT:15,ENTROPY_SOURCE:16,HASH:17,KDF:18,KEM:19,KEY:20,KEY_ALG:21,KEY_CIPHER:22,KEY_DESERIALIZER:23,KEY_SERIALIZER:24,KEY_SIGNER:25,MAC:26,MESSAGE_INFO_FOOTER_SERIALIZER:27,MESSAGE_INFO_SERIALIZER:28,PADDING:29,PRIVATE_KEY:30,PUBLIC_KEY:31,RANDOM:32,SALTED_KDF:33});var s=(t,e)=>Object.freeze({AES256_CBC:1,AES256_GCM:2,ALG_INFO_DER_DESERIALIZER:3,ALG_INFO_DER_SERIALIZER:4,ASN1RD:5,ASN1WR:6,CIPHER_ALG_INFO:7,COMPOUND_KEY_ALG:8,COMPOUND_KEY_ALG_INFO:9,COMPOUND_PRIVATE_KEY:10,COMPOUND_PUBLIC_KEY:11,CTR_DRBG:12,CURVE25519:13,ECC:14,ECC_ALG_INFO:15,ECC_PRIVATE_KEY:16,ECC_PUBLIC_KEY:17,ED25519:18,ENTROPY_ACCUMULATOR:19,FAKE_RANDOM:20,FALCON:21,HASH_BASED_ALG_INFO:22,HKDF:23,HMAC:24,HYBRID_KEY_ALG:25,HYBRID_KEY_ALG_INFO:26,HYBRID_PRIVATE_KEY:27,HYBRID_PUBLIC_KEY:28,KDF1:29,KDF2:30,KEY_ASN1_DESERIALIZER:31,KEY_ASN1_SERIALIZER:32,KEY_MATERIAL_RNG:33,MESSAGE_INFO_DER_SERIALIZER:34,PBE_ALG_INFO:35,PKCS5_PBES2:36,PKCS5_PBKDF2:37,PKCS8_SERIALIZER:38,RANDOM_PADDING:39,RAW_PRIVATE_KEY:40,RAW_PUBLIC_KEY:41,ROUND5:42,RSA:43,RSA_PRIVATE_KEY:44,RSA_PUBLIC_KEY:45,SALTED_KDF_ALG_INFO:46,SEC1_SERIALIZER:47,SEED_ENTROPY_SOURCE:48,SHA224:49,SHA256:50,SHA384:51,SHA512:52,SIMPLE_ALG_INFO:53});function _(t,e){if(!("number"==typeof e||e instanceof Number))throw new TypeError(`'${t}' is not a number`);if(Number.isNaN(e))throw new TypeError(`'${t}' is NaN`);if(e===1/0)throw new TypeError(`'${t}' is Infinity`);if(e===-1/0)throw new TypeError(`'${t}' is -Infinity`)}function c(t,e){if(_(t,e),0==e)throw new TypeError(`'${t}' is NULL`)}var a={ensureNumber:_,ensureString:function(t,e){if(!("string"==typeof e||e instanceof String))throw new TypeError(`'${t}' is not a string`)},ensureBoolean:function(t,e){if("boolean"!=typeof e)throw new TypeError(`'${t}' is not a boolean`)},ensureByteArray:function(t,e){if(!(e instanceof Uint8Array))throw new TypeError(`'${t}' is not an Uint8Array`)},ensureClass:function(t,e,r){if(!(e instanceof r))throw new TypeError(`'${t}' is not an instance of the class ${r.name}`);c(t,e.ctxPtr)},ensureNotNull:c,ensureImplementInterface:function(t,e,r,n,s){if(c(t,e.ctxPtr),!s.isImplemented(e.ctxPtr,n))throw new TypeError(`'${t}' does not implement interface '${r}'`)}};var o=(t,e)=>{class r{static get RESEED_INTERVAL(){return 1e4}get RESEED_INTERVAL(){return r.RESEED_INTERVAL}static get ENTROPY_LEN(){return 48}get ENTROPY_LEN(){return r.ENTROPY_LEN}constructor(e){this.name="CtrDrbg",this.ctxPtr=void 0===e?t._vscf_ctr_drbg_new():e}static newAndUseCContext(e){return new r(t._vscf_ctr_drbg_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscf_ctr_drbg_delete(this.ctxPtr),this.ctxPtr=null)}set entropySource(r){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureImplementInterface("entropySource",r,"Foundation.EntropySource",e.FoundationInterfaceTag.ENTROPY_SOURCE,e.FoundationInterface),t._vscf_ctr_drbg_release_entropy_source(this.ctxPtr);const n=t._vscf_ctr_drbg_use_entropy_source(this.ctxPtr,r.ctxPtr);e.FoundationError.handleStatusCode(n)}random(r){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureNumber("dataLen",r);const n=r,s=t._vsc_buffer_new_with_capacity(n);try{const n=t._vscf_ctr_drbg_random(this.ctxPtr,r,s);e.FoundationError.handleStatusCode(n);const _=t._vsc_buffer_bytes(s),c=t._vsc_buffer_len(s);return t.HEAPU8.slice(_,_+c)}finally{t._vsc_buffer_delete(s)}}reseed(){a.ensureNotNull("this.ctxPtr",this.ctxPtr);const r=t._vscf_ctr_drbg_reseed(this.ctxPtr);e.FoundationError.handleStatusCode(r)}setupDefaults(){a.ensureNotNull("this.ctxPtr",this.ctxPtr);const r=t._vscf_ctr_drbg_setup_defaults(this.ctxPtr);e.FoundationError.handleStatusCode(r)}enablePredictionResistance(){a.ensureNotNull("this.ctxPtr",this.ctxPtr),t._vscf_ctr_drbg_enable_prediction_resistance(this.ctxPtr)}setReseedInterval(e){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureNumber("interval",e),t._vscf_ctr_drbg_set_reseed_interval(this.ctxPtr,e)}setEntropyLen(e){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureNumber("len",e),t._vscf_ctr_drbg_set_entropy_len(this.ctxPtr,e)}}return r};var i=(t,e)=>{class r{constructor(e){this.name="Hmac",this.ctxPtr=void 0===e?t._vscf_hmac_new():e}static newAndUseCContext(e){return new r(t._vscf_hmac_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscf_hmac_delete(this.ctxPtr),this.ctxPtr=null)}set hash(r){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureImplementInterface("hash",r,"Foundation.Hash",e.FoundationInterfaceTag.HASH,e.FoundationInterface),t._vscf_hmac_release_hash(this.ctxPtr),t._vscf_hmac_use_hash(this.ctxPtr,r.ctxPtr)}algId(){let e;return a.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscf_hmac_alg_id(this.ctxPtr),e}produceAlgInfo(){let r;return a.ensureNotNull("this.ctxPtr",this.ctxPtr),r=t._vscf_hmac_produce_alg_info(this.ctxPtr),e.FoundationInterface.newAndTakeCContext(r)}restoreAlgInfo(r){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureImplementInterface("algInfo",r,"Foundation.AlgInfo",e.FoundationInterfaceTag.ALG_INFO,e.FoundationInterface);const n=t._vscf_hmac_restore_alg_info(this.ctxPtr,r.ctxPtr);e.FoundationError.handleStatusCode(n)}digestLen(){let e;return a.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscf_hmac_digest_len(this.ctxPtr),e}mac(e,r){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureByteArray("key",e),a.ensureByteArray("data",r);const n=e.length*e.BYTES_PER_ELEMENT,s=t._malloc(n);t.HEAP8.set(e,s);const _=t._vsc_data_ctx_size(),c=t._malloc(_);t._vsc_data(c,s,n);const o=r.length*r.BYTES_PER_ELEMENT,i=t._malloc(o);t.HEAP8.set(r,i);const u=t._vsc_data_ctx_size(),l=t._malloc(u);t._vsc_data(l,i,o);const f=this.digestLen(),h=t._vsc_buffer_new_with_capacity(f);try{t._vscf_hmac_mac(this.ctxPtr,c,l,h);const e=t._vsc_buffer_bytes(h),r=t._vsc_buffer_len(h);return t.HEAPU8.slice(e,e+r)}finally{t._free(s),t._free(c),t._free(i),t._free(l),t._vsc_buffer_delete(h)}}start(e){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureByteArray("key",e);const r=e.length*e.BYTES_PER_ELEMENT,n=t._malloc(r);t.HEAP8.set(e,n);const s=t._vsc_data_ctx_size(),_=t._malloc(s);t._vsc_data(_,n,r);try{t._vscf_hmac_start(this.ctxPtr,_)}finally{t._free(n),t._free(_)}}update(e){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureByteArray("data",e);const r=e.length*e.BYTES_PER_ELEMENT,n=t._malloc(r);t.HEAP8.set(e,n);const s=t._vsc_data_ctx_size(),_=t._malloc(s);t._vsc_data(_,n,r);try{t._vscf_hmac_update(this.ctxPtr,_)}finally{t._free(n),t._free(_)}}finish(){a.ensureNotNull("this.ctxPtr",this.ctxPtr);const e=this.digestLen(),r=t._vsc_buffer_new_with_capacity(e);try{t._vscf_hmac_finish(this.ctxPtr,r);const e=t._vsc_buffer_bytes(r),n=t._vsc_buffer_len(r);return t.HEAPU8.slice(e,e+n)}finally{t._vsc_buffer_delete(r)}}reset(){a.ensureNotNull("this.ctxPtr",this.ctxPtr),t._vscf_hmac_reset(this.ctxPtr)}}return r};var u=(t,e)=>{class r{constructor(e){this.name="Hkdf",this.ctxPtr=void 0===e?t._vscf_hkdf_new():e}static newAndUseCContext(e){return new r(t._vscf_hkdf_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscf_hkdf_delete(this.ctxPtr),this.ctxPtr=null)}set hash(r){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureImplementInterface("hash",r,"Foundation.Hash",e.FoundationInterfaceTag.HASH,e.FoundationInterface),t._vscf_hkdf_release_hash(this.ctxPtr),t._vscf_hkdf_use_hash(this.ctxPtr,r.ctxPtr)}algId(){let e;return a.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscf_hkdf_alg_id(this.ctxPtr),e}produceAlgInfo(){let r;return a.ensureNotNull("this.ctxPtr",this.ctxPtr),r=t._vscf_hkdf_produce_alg_info(this.ctxPtr),e.FoundationInterface.newAndTakeCContext(r)}restoreAlgInfo(r){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureImplementInterface("algInfo",r,"Foundation.AlgInfo",e.FoundationInterfaceTag.ALG_INFO,e.FoundationInterface);const n=t._vscf_hkdf_restore_alg_info(this.ctxPtr,r.ctxPtr);e.FoundationError.handleStatusCode(n)}derive(e,r){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureByteArray("data",e),a.ensureNumber("keyLen",r);const n=e.length*e.BYTES_PER_ELEMENT,s=t._malloc(n);t.HEAP8.set(e,s);const _=t._vsc_data_ctx_size(),c=t._malloc(_);t._vsc_data(c,s,n);const o=r,i=t._vsc_buffer_new_with_capacity(o);try{t._vscf_hkdf_derive(this.ctxPtr,c,r,i);const e=t._vsc_buffer_bytes(i),n=t._vsc_buffer_len(i);return t.HEAPU8.slice(e,e+n)}finally{t._free(s),t._free(c),t._vsc_buffer_delete(i)}}reset(e,r){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureByteArray("salt",e),a.ensureNumber("iterationCount",r);const n=e.length*e.BYTES_PER_ELEMENT,s=t._malloc(n);t.HEAP8.set(e,s);const _=t._vsc_data_ctx_size(),c=t._malloc(_);t._vsc_data(c,s,n);try{t._vscf_hkdf_reset(this.ctxPtr,c,r)}finally{t._free(s),t._free(c)}}setInfo(e){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureByteArray("info",e);const r=e.length*e.BYTES_PER_ELEMENT,n=t._malloc(r);t.HEAP8.set(e,n);const s=t._vsc_data_ctx_size(),_=t._malloc(s);t._vsc_data(_,n,r);try{t._vscf_hkdf_set_info(this.ctxPtr,_)}finally{t._free(n),t._free(_)}}}return r};var l=(t,e)=>{class r{static get DIGEST_LEN(){return 64}get DIGEST_LEN(){return r.DIGEST_LEN}static get BLOCK_LEN(){return 128}get BLOCK_LEN(){return r.BLOCK_LEN}constructor(e){this.name="Sha512",this.ctxPtr=void 0===e?t._vscf_sha512_new():e}static newAndUseCContext(e){return new r(t._vscf_sha512_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscf_sha512_delete(this.ctxPtr),this.ctxPtr=null)}algId(){let e;return a.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscf_sha512_alg_id(this.ctxPtr),e}produceAlgInfo(){let r;return a.ensureNotNull("this.ctxPtr",this.ctxPtr),r=t._vscf_sha512_produce_alg_info(this.ctxPtr),e.FoundationInterface.newAndTakeCContext(r)}restoreAlgInfo(r){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureImplementInterface("algInfo",r,"Foundation.AlgInfo",e.FoundationInterfaceTag.ALG_INFO,e.FoundationInterface);const n=t._vscf_sha512_restore_alg_info(this.ctxPtr,r.ctxPtr);e.FoundationError.handleStatusCode(n)}hash(e){a.ensureByteArray("data",e);const r=e.length*e.BYTES_PER_ELEMENT,n=t._malloc(r);t.HEAP8.set(e,n);const s=t._vsc_data_ctx_size(),_=t._malloc(s);t._vsc_data(_,n,r);const c=this.DIGEST_LEN,o=t._vsc_buffer_new_with_capacity(c);try{t._vscf_sha512_hash(_,o);const e=t._vsc_buffer_bytes(o),r=t._vsc_buffer_len(o);return t.HEAPU8.slice(e,e+r)}finally{t._free(n),t._free(_),t._vsc_buffer_delete(o)}}start(){a.ensureNotNull("this.ctxPtr",this.ctxPtr),t._vscf_sha512_start(this.ctxPtr)}update(e){a.ensureNotNull("this.ctxPtr",this.ctxPtr),a.ensureByteArray("data",e);const r=e.length*e.BYTES_PER_ELEMENT,n=t._malloc(r);t.HEAP8.set(e,n);const s=t._vsc_data_ctx_size(),_=t._malloc(s);t._vsc_data(_,n,r);try{t._vscf_sha512_update(this.ctxPtr,_)}finally{t._free(n),t._free(_)}}finish(){a.ensureNotNull("this.ctxPtr",this.ctxPtr);const e=this.DIGEST_LEN,r=t._vsc_buffer_new_with_capacity(e);try{t._vscf_sha512_finish(this.ctxPtr,r);const e=t._vsc_buffer_bytes(r),n=t._vsc_buffer_len(r);return t.HEAPU8.slice(e,e+n)}finally{t._vsc_buffer_delete(r)}}}return r};var f=(t,e)=>{class r extends Error{constructor(t){super(t),this.name="RatchetError",this.message=t}static handleStatusCode(t){if(0!=t){if(-1==t)throw new r("Error during protobuf deserialization.");if(-2==t)throw new r("Bad message type.");if(-3==t)throw new r("AES error.");if(-4==t)throw new r("RNG failed.");if(-5==t)throw new r("Curve25519 error.");if(-6==t)throw new r("Curve25519 error.");if(-7==t)throw new r("Key deserialization failed.");if(-8==t)throw new r("Invalid key type.");if(-9==t)throw new r("Identity key doesn't match.");if(-10==t)throw new r("Message already decrypted.");if(-11==t)throw new r("Too many lost messages.");if(-12==t)throw new r("Sender chain missing.");if(-13==t)throw new r("Skipped message missing.");if(-14==t)throw new r("Session is not initialized.");if(-15==t)throw new r("Exceeded max plain text len.");if(-16==t)throw new r("Too many messages for sender chain.");if(-17==t)throw new r("Too many messages for receiver chain.");if(-18==t)throw new r("Invalid padding.");if(-19==t)throw new r("Too many participants.");if(-20==t)throw new r("Too few participants.");if(-21==t)throw new r("Sender not found.");if(-22==t)throw new r("Cannot decrypt own messages.");if(-23==t)throw new r("Invalid signature.");if(-24==t)throw new r("Cannot remove myself.");if(-25==t)throw new r("Epoch mismatch.");if(-26==t)throw new r("Epoch not found.");if(-27==t)throw new r("Session id mismatch.");if(-28==t)throw new r("Simultaneous group user operation.");if(-29==t)throw new r("Myself is included in info.");throw new r("Unexpected status code:"+t)}}}return r};var h=(t,e)=>Object.freeze({REGULAR:0,PREKEY:1});var d=(t,e)=>Object.freeze({GROUP_INFO:0,REGULAR:1});function p(t,e){if(!("number"==typeof e||e instanceof Number))throw new TypeError(`'${t}' is not a number`);if(Number.isNaN(e))throw new TypeError(`'${t}' is NaN`);if(e===1/0)throw new TypeError(`'${t}' is Infinity`);if(e===-1/0)throw new TypeError(`'${t}' is -Infinity`)}function v(t,e){if(p(t,e),0==e)throw new TypeError(`'${t}' is NULL`)}var m={ensureNumber:p,ensureString:function(t,e){if(!("string"==typeof e||e instanceof String))throw new TypeError(`'${t}' is not a string`)},ensureBoolean:function(t,e){if("boolean"!=typeof e)throw new TypeError(`'${t}' is not a boolean`)},ensureByteArray:function(t,e){if(!(e instanceof Uint8Array))throw new TypeError(`'${t}' is not an Uint8Array`)},ensureClass:function(t,e,r){if(!(e instanceof r))throw new TypeError(`'${t}' is not an instance of the class ${r.name}`);v(t,e.ctxPtr)},ensureNotNull:v,ensureImplementInterface:function(t,e,r,n,s){if(v(t,e.ctxPtr),!s.isImplemented(e.ctxPtr,n))throw new TypeError(`'${t}' does not implement interface '${r}'`)}};var y=(t,e)=>{class r{static get MAX_PLAIN_TEXT_LEN(){return 3e4}get MAX_PLAIN_TEXT_LEN(){return r.MAX_PLAIN_TEXT_LEN}static get MAX_MESSAGE_LEN(){return 32975}get MAX_MESSAGE_LEN(){return r.MAX_MESSAGE_LEN}static get KEY_ID_LEN(){return 8}get KEY_ID_LEN(){return r.KEY_ID_LEN}static get PARTICIPANT_ID_LEN(){return 32}get PARTICIPANT_ID_LEN(){return r.PARTICIPANT_ID_LEN}static get SESSION_ID_LEN(){return 32}get SESSION_ID_LEN(){return r.SESSION_ID_LEN}static get MAX_PARTICIPANTS_COUNT(){return 100}get MAX_PARTICIPANTS_COUNT(){return r.MAX_PARTICIPANTS_COUNT}static get MIN_PARTICIPANTS_COUNT(){return 2}get MIN_PARTICIPANTS_COUNT(){return r.MIN_PARTICIPANTS_COUNT}static get MAX_GROUP_MESSAGE_LEN(){return 32918}get MAX_GROUP_MESSAGE_LEN(){return r.MAX_GROUP_MESSAGE_LEN}}return r};var w=(t,e)=>{class r{constructor(e){this.name="RatchetKeyId",this.ctxPtr=void 0===e?t._vscr_ratchet_key_id_new():e}static newAndUseCContext(e){return new r(t._vscr_ratchet_key_id_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscr_ratchet_key_id_delete(this.ctxPtr),this.ctxPtr=null)}computePublicKeyId(r){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureByteArray("publicKey",r);const n=r.length*r.BYTES_PER_ELEMENT,s=t._malloc(n);t.HEAP8.set(r,s);const _=t._vsc_data_ctx_size(),c=t._malloc(_);t._vsc_data(c,s,n);const a=e.RatchetCommon.KEY_ID_LEN,o=t._vsc_buffer_new_with_capacity(a);try{const r=t._vscr_ratchet_key_id_compute_public_key_id(this.ctxPtr,c,o);e.RatchetError.handleStatusCode(r);const n=t._vsc_buffer_bytes(o),_=t._vsc_buffer_len(o);return t.HEAPU8.slice(n,n+_)}finally{t._free(s),t._free(c),t._vsc_buffer_delete(o)}}}return r};var g=(t,e)=>{class r{constructor(e){this.name="RatchetMessage",this.ctxPtr=void 0===e?t._vscr_ratchet_message_new():e}static newAndUseCContext(e){return new r(t._vscr_ratchet_message_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscr_ratchet_message_delete(this.ctxPtr),this.ctxPtr=null)}getType(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_message_get_type(this.ctxPtr),e}getCounter(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_message_get_counter(this.ctxPtr),e}getLongTermPublicKey(){m.ensureNotNull("this.ctxPtr",this.ctxPtr);const e=t._vsc_data_ctx_size(),r=t._malloc(e);try{t._vscr_ratchet_message_get_long_term_public_key(r,this.ctxPtr);const e=t._vsc_data_len(r),n=t._vsc_data_bytes(r);return t.HEAPU8.slice(n,n+e)}finally{t._free(r)}}getOneTimePublicKey(){m.ensureNotNull("this.ctxPtr",this.ctxPtr);const e=t._vsc_data_ctx_size(),r=t._malloc(e);try{t._vscr_ratchet_message_get_one_time_public_key(r,this.ctxPtr);const e=t._vsc_data_len(r),n=t._vsc_data_bytes(r);return t.HEAPU8.slice(n,n+e)}finally{t._free(r)}}serializeLen(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_message_serialize_len(this.ctxPtr),e}serialize(){m.ensureNotNull("this.ctxPtr",this.ctxPtr);const e=this.serializeLen(),r=t._vsc_buffer_new_with_capacity(e);try{t._vscr_ratchet_message_serialize(this.ctxPtr,r);const e=t._vsc_buffer_bytes(r),n=t._vsc_buffer_len(r);return t.HEAPU8.slice(e,e+n)}finally{t._vsc_buffer_delete(r)}}static deserialize(n){m.ensureByteArray("input",n);const s=n.length*n.BYTES_PER_ELEMENT,_=t._malloc(s);t.HEAP8.set(n,_);const c=t._vsc_data_ctx_size(),a=t._malloc(c);t._vsc_data(a,_,s);const o=t._vscr_error_ctx_size(),i=t._malloc(o);let u;t._vscr_error_reset(i);try{u=t._vscr_ratchet_message_deserialize(a,i);const n=t._vscr_error_status(i);return e.RatchetError.handleStatusCode(n),r.newAndTakeCContext(u)}finally{t._free(_),t._free(a),t._free(i)}}}return r};var P=(t,e)=>{class r{constructor(e){this.name="RatchetSession",this.ctxPtr=void 0===e?t._vscr_ratchet_session_new():e}static newAndUseCContext(e){return new r(t._vscr_ratchet_session_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscr_ratchet_session_delete(this.ctxPtr),this.ctxPtr=null)}set rng(r){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureImplementInterface("rng",r,"Foundation.Random",e.FoundationInterfaceTag.RANDOM,e.FoundationInterface),t._vscr_ratchet_session_release_rng(this.ctxPtr),t._vscr_ratchet_session_use_rng(this.ctxPtr,r.ctxPtr)}setupDefaults(){m.ensureNotNull("this.ctxPtr",this.ctxPtr);const r=t._vscr_ratchet_session_setup_defaults(this.ctxPtr);e.RatchetError.handleStatusCode(r)}initiate(r,n,s,_){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureByteArray("senderIdentityPrivateKey",r),m.ensureByteArray("receiverIdentityPublicKey",n),m.ensureByteArray("receiverLongTermPublicKey",s),m.ensureByteArray("receiverOneTimePublicKey",_);const c=r.length*r.BYTES_PER_ELEMENT,a=t._malloc(c);t.HEAP8.set(r,a);const o=t._vsc_data_ctx_size(),i=t._malloc(o);t._vsc_data(i,a,c);const u=n.length*n.BYTES_PER_ELEMENT,l=t._malloc(u);t.HEAP8.set(n,l);const f=t._vsc_data_ctx_size(),h=t._malloc(f);t._vsc_data(h,l,u);const d=s.length*s.BYTES_PER_ELEMENT,p=t._malloc(d);t.HEAP8.set(s,p);const v=t._vsc_data_ctx_size(),y=t._malloc(v);t._vsc_data(y,p,d);const w=_.length*_.BYTES_PER_ELEMENT,g=t._malloc(w);t.HEAP8.set(_,g);const P=t._vsc_data_ctx_size(),E=t._malloc(P);t._vsc_data(E,g,w);try{const r=t._vscr_ratchet_session_initiate(this.ctxPtr,i,h,y,E);e.RatchetError.handleStatusCode(r)}finally{t._free(a),t._free(i),t._free(l),t._free(h),t._free(p),t._free(y),t._free(g),t._free(E)}}respond(r,n,s,_,c){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureByteArray("senderIdentityPublicKey",r),m.ensureByteArray("receiverIdentityPrivateKey",n),m.ensureByteArray("receiverLongTermPrivateKey",s),m.ensureByteArray("receiverOneTimePrivateKey",_),m.ensureClass("message",c,e.RatchetMessage);const a=r.length*r.BYTES_PER_ELEMENT,o=t._malloc(a);t.HEAP8.set(r,o);const i=t._vsc_data_ctx_size(),u=t._malloc(i);t._vsc_data(u,o,a);const l=n.length*n.BYTES_PER_ELEMENT,f=t._malloc(l);t.HEAP8.set(n,f);const h=t._vsc_data_ctx_size(),d=t._malloc(h);t._vsc_data(d,f,l);const p=s.length*s.BYTES_PER_ELEMENT,v=t._malloc(p);t.HEAP8.set(s,v);const y=t._vsc_data_ctx_size(),w=t._malloc(y);t._vsc_data(w,v,p);const g=_.length*_.BYTES_PER_ELEMENT,P=t._malloc(g);t.HEAP8.set(_,P);const E=t._vsc_data_ctx_size(),x=t._malloc(E);t._vsc_data(x,P,g);try{const r=t._vscr_ratchet_session_respond(this.ctxPtr,u,d,w,x,c.ctxPtr);e.RatchetError.handleStatusCode(r)}finally{t._free(o),t._free(u),t._free(f),t._free(d),t._free(v),t._free(w),t._free(P),t._free(x)}}isInitiator(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_session_is_initiator(this.ctxPtr),!!e}receivedFirstResponse(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_session_received_first_response(this.ctxPtr),!!e}receiverHasOneTimePublicKey(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_session_receiver_has_one_time_public_key(this.ctxPtr),!!e}encrypt(r){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureByteArray("plainText",r);const n=r.length*r.BYTES_PER_ELEMENT,s=t._malloc(n);t.HEAP8.set(r,s);const _=t._vsc_data_ctx_size(),c=t._malloc(_);t._vsc_data(c,s,n);const a=t._vscr_error_ctx_size(),o=t._malloc(a);let i;t._vscr_error_reset(o);try{i=t._vscr_ratchet_session_encrypt(this.ctxPtr,c,o);const r=t._vscr_error_status(o);return e.RatchetError.handleStatusCode(r),e.RatchetMessage.newAndTakeCContext(i)}finally{t._free(s),t._free(c),t._free(o)}}decryptLen(r){let n;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureClass("message",r,e.RatchetMessage),n=t._vscr_ratchet_session_decrypt_len(this.ctxPtr,r.ctxPtr),n}decrypt(r){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureClass("message",r,e.RatchetMessage);const n=this.decryptLen(r),s=t._vsc_buffer_new_with_capacity(n);try{const n=t._vscr_ratchet_session_decrypt(this.ctxPtr,r.ctxPtr,s);e.RatchetError.handleStatusCode(n);const _=t._vsc_buffer_bytes(s),c=t._vsc_buffer_len(s);return t.HEAPU8.slice(_,_+c)}finally{t._vsc_buffer_delete(s)}}serialize(){let e;m.ensureNotNull("this.ctxPtr",this.ctxPtr);try{e=t._vscr_ratchet_session_serialize(this.ctxPtr);const r=t._vsc_buffer_len(e),n=t._vsc_buffer_bytes(e);return t.HEAPU8.slice(n,n+r)}finally{t._vsc_buffer_delete(e)}}static deserialize(n){m.ensureByteArray("input",n);const s=n.length*n.BYTES_PER_ELEMENT,_=t._malloc(s);t.HEAP8.set(n,_);const c=t._vsc_data_ctx_size(),a=t._malloc(c);t._vsc_data(a,_,s);const o=t._vscr_error_ctx_size(),i=t._malloc(o);let u;t._vscr_error_reset(i);try{u=t._vscr_ratchet_session_deserialize(a,i);const n=t._vscr_error_status(i);return e.RatchetError.handleStatusCode(n),r.newAndTakeCContext(u)}finally{t._free(_),t._free(a),t._free(i)}}}return r};var E=(t,e)=>{class r{constructor(e){this.name="RatchetGroupParticipantsInfo",this.ctxPtr=void 0===e?t._vscr_ratchet_group_participants_info_new():e}static newAndUseCContext(e){return new r(t._vscr_ratchet_group_participants_info_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscr_ratchet_group_participants_info_delete(this.ctxPtr),this.ctxPtr=null)}static newSize(e){let n;return m.ensureNumber("size",e),n=t._vscr_ratchet_group_participants_info_new_size(e),r.newAndTakeCContext(n)}addParticipant(r,n){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureByteArray("id",r),m.ensureByteArray("pubKey",n);const s=r.length*r.BYTES_PER_ELEMENT,_=t._malloc(s);t.HEAP8.set(r,_);const c=t._vsc_data_ctx_size(),a=t._malloc(c);t._vsc_data(a,_,s);const o=n.length*n.BYTES_PER_ELEMENT,i=t._malloc(o);t.HEAP8.set(n,i);const u=t._vsc_data_ctx_size(),l=t._malloc(u);t._vsc_data(l,i,o);try{const r=t._vscr_ratchet_group_participants_info_add_participant(this.ctxPtr,a,l);e.RatchetError.handleStatusCode(r)}finally{t._free(_),t._free(a),t._free(i),t._free(l)}}}return r};var x=(t,e)=>{class r{constructor(e){this.name="RatchetGroupMessage",this.ctxPtr=void 0===e?t._vscr_ratchet_group_message_new():e}static newAndUseCContext(e){return new r(t._vscr_ratchet_group_message_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscr_ratchet_group_message_delete(this.ctxPtr),this.ctxPtr=null)}getType(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_group_message_get_type(this.ctxPtr),e}getSessionId(){m.ensureNotNull("this.ctxPtr",this.ctxPtr);const e=t._vsc_data_ctx_size(),r=t._malloc(e);try{t._vscr_ratchet_group_message_get_session_id(r,this.ctxPtr);const e=t._vsc_data_len(r),n=t._vsc_data_bytes(r);return t.HEAPU8.slice(n,n+e)}finally{t._free(r)}}getCounter(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_group_message_get_counter(this.ctxPtr),e}getEpoch(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_group_message_get_epoch(this.ctxPtr),e}serializeLen(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_group_message_serialize_len(this.ctxPtr),e}serialize(){m.ensureNotNull("this.ctxPtr",this.ctxPtr);const e=this.serializeLen(),r=t._vsc_buffer_new_with_capacity(e);try{t._vscr_ratchet_group_message_serialize(this.ctxPtr,r);const e=t._vsc_buffer_bytes(r),n=t._vsc_buffer_len(r);return t.HEAPU8.slice(e,e+n)}finally{t._vsc_buffer_delete(r)}}static deserialize(n){m.ensureByteArray("input",n);const s=n.length*n.BYTES_PER_ELEMENT,_=t._malloc(s);t.HEAP8.set(n,_);const c=t._vsc_data_ctx_size(),a=t._malloc(c);t._vsc_data(a,_,s);const o=t._vscr_error_ctx_size(),i=t._malloc(o);let u;t._vscr_error_reset(i);try{u=t._vscr_ratchet_group_message_deserialize(a,i);const n=t._vscr_error_status(i);return e.RatchetError.handleStatusCode(n),r.newAndTakeCContext(u)}finally{t._free(_),t._free(a),t._free(i)}}}return r};var A=(t,e)=>{class r{constructor(e){this.name="RatchetGroupTicket",this.ctxPtr=void 0===e?t._vscr_ratchet_group_ticket_new():e}static newAndUseCContext(e){return new r(t._vscr_ratchet_group_ticket_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscr_ratchet_group_ticket_delete(this.ctxPtr),this.ctxPtr=null)}set rng(r){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureImplementInterface("rng",r,"Foundation.Random",e.FoundationInterfaceTag.RANDOM,e.FoundationInterface),t._vscr_ratchet_group_ticket_release_rng(this.ctxPtr),t._vscr_ratchet_group_ticket_use_rng(this.ctxPtr,r.ctxPtr)}setupDefaults(){m.ensureNotNull("this.ctxPtr",this.ctxPtr);const r=t._vscr_ratchet_group_ticket_setup_defaults(this.ctxPtr);e.RatchetError.handleStatusCode(r)}setupTicketAsNew(r){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureByteArray("sessionId",r);const n=r.length*r.BYTES_PER_ELEMENT,s=t._malloc(n);t.HEAP8.set(r,s);const _=t._vsc_data_ctx_size(),c=t._malloc(_);t._vsc_data(c,s,n);try{const r=t._vscr_ratchet_group_ticket_setup_ticket_as_new(this.ctxPtr,c);e.RatchetError.handleStatusCode(r)}finally{t._free(s),t._free(c)}}getTicketMessage(){let r;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),r=t._vscr_ratchet_group_ticket_get_ticket_message(this.ctxPtr),e.RatchetGroupMessage.newAndUseCContext(r)}}return r};var b=(t,e)=>{class r{constructor(e){this.name="RatchetGroupParticipantsIds",this.ctxPtr=void 0===e?t._vscr_ratchet_group_participants_ids_new():e}static newAndUseCContext(e){return new r(t._vscr_ratchet_group_participants_ids_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscr_ratchet_group_participants_ids_delete(this.ctxPtr),this.ctxPtr=null)}static newSize(e){let n;return m.ensureNumber("size",e),n=t._vscr_ratchet_group_participants_ids_new_size(e),r.newAndTakeCContext(n)}addId(e){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureByteArray("id",e);const r=e.length*e.BYTES_PER_ELEMENT,n=t._malloc(r);t.HEAP8.set(e,n);const s=t._vsc_data_ctx_size(),_=t._malloc(s);t._vsc_data(_,n,r);try{t._vscr_ratchet_group_participants_ids_add_id(this.ctxPtr,_)}finally{t._free(n),t._free(_)}}}return r};var C=(t,e)=>{class r{constructor(e){this.name="RatchetGroupSession",this.ctxPtr=void 0===e?t._vscr_ratchet_group_session_new():e}static newAndUseCContext(e){return new r(t._vscr_ratchet_group_session_shallow_copy(e))}static newAndTakeCContext(t){return new r(t)}delete(){void 0!==this.ctxPtr&&null!==this.ctxPtr&&(t._vscr_ratchet_group_session_delete(this.ctxPtr),this.ctxPtr=null)}set rng(r){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureImplementInterface("rng",r,"Foundation.Random",e.FoundationInterfaceTag.RANDOM,e.FoundationInterface),t._vscr_ratchet_group_session_release_rng(this.ctxPtr),t._vscr_ratchet_group_session_use_rng(this.ctxPtr,r.ctxPtr)}isInitialized(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_group_session_is_initialized(this.ctxPtr),!!e}isPrivateKeySet(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_group_session_is_private_key_set(this.ctxPtr),!!e}isMyIdSet(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_group_session_is_my_id_set(this.ctxPtr),!!e}getCurrentEpoch(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_group_session_get_current_epoch(this.ctxPtr),e}setupDefaults(){m.ensureNotNull("this.ctxPtr",this.ctxPtr);const r=t._vscr_ratchet_group_session_setup_defaults(this.ctxPtr);e.RatchetError.handleStatusCode(r)}setPrivateKey(r){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureByteArray("myPrivateKey",r);const n=r.length*r.BYTES_PER_ELEMENT,s=t._malloc(n);t.HEAP8.set(r,s);const _=t._vsc_data_ctx_size(),c=t._malloc(_);t._vsc_data(c,s,n);try{const r=t._vscr_ratchet_group_session_set_private_key(this.ctxPtr,c);e.RatchetError.handleStatusCode(r)}finally{t._free(s),t._free(c)}}setMyId(e){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureByteArray("myId",e);const r=e.length*e.BYTES_PER_ELEMENT,n=t._malloc(r);t.HEAP8.set(e,n);const s=t._vsc_data_ctx_size(),_=t._malloc(s);t._vsc_data(_,n,r);try{t._vscr_ratchet_group_session_set_my_id(this.ctxPtr,_)}finally{t._free(n),t._free(_)}}getMyId(){m.ensureNotNull("this.ctxPtr",this.ctxPtr);const e=t._vsc_data_ctx_size(),r=t._malloc(e);try{t._vscr_ratchet_group_session_get_my_id(r,this.ctxPtr);const e=t._vsc_data_len(r),n=t._vsc_data_bytes(r);return t.HEAPU8.slice(n,n+e)}finally{t._free(r)}}getSessionId(){m.ensureNotNull("this.ctxPtr",this.ctxPtr);const e=t._vsc_data_ctx_size(),r=t._malloc(e);try{t._vscr_ratchet_group_session_get_session_id(r,this.ctxPtr);const e=t._vsc_data_len(r),n=t._vsc_data_bytes(r);return t.HEAPU8.slice(n,n+e)}finally{t._free(r)}}getParticipantsCount(){let e;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),e=t._vscr_ratchet_group_session_get_participants_count(this.ctxPtr),e}setupSessionState(r,n){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureClass("message",r,e.RatchetGroupMessage),m.ensureClass("participants",n,e.RatchetGroupParticipantsInfo);const s=t._vscr_ratchet_group_session_setup_session_state(this.ctxPtr,r.ctxPtr,n.ctxPtr);e.RatchetError.handleStatusCode(s)}updateSessionState(r,n,s){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureClass("message",r,e.RatchetGroupMessage),m.ensureClass("addParticipants",n,e.RatchetGroupParticipantsInfo),m.ensureClass("removeParticipants",s,e.RatchetGroupParticipantsIds);const _=t._vscr_ratchet_group_session_update_session_state(this.ctxPtr,r.ctxPtr,n.ctxPtr,s.ctxPtr);e.RatchetError.handleStatusCode(_)}encrypt(r){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureByteArray("plainText",r);const n=r.length*r.BYTES_PER_ELEMENT,s=t._malloc(n);t.HEAP8.set(r,s);const _=t._vsc_data_ctx_size(),c=t._malloc(_);t._vsc_data(c,s,n);const a=t._vscr_error_ctx_size(),o=t._malloc(a);let i;t._vscr_error_reset(o);try{i=t._vscr_ratchet_group_session_encrypt(this.ctxPtr,c,o);const r=t._vscr_error_status(o);return e.RatchetError.handleStatusCode(r),e.RatchetGroupMessage.newAndTakeCContext(i)}finally{t._free(s),t._free(c),t._free(o)}}decryptLen(r){let n;return m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureClass("message",r,e.RatchetGroupMessage),n=t._vscr_ratchet_group_session_decrypt_len(this.ctxPtr,r.ctxPtr),n}decrypt(r,n){m.ensureNotNull("this.ctxPtr",this.ctxPtr),m.ensureClass("message",r,e.RatchetGroupMessage),m.ensureByteArray("senderId",n);const s=n.length*n.BYTES_PER_ELEMENT,_=t._malloc(s);t.HEAP8.set(n,_);const c=t._vsc_data_ctx_size(),a=t._malloc(c);t._vsc_data(a,_,s);const o=this.decryptLen(r),i=t._vsc_buffer_new_with_capacity(o);try{const n=t._vscr_ratchet_group_session_decrypt(this.ctxPtr,r.ctxPtr,a,i);e.RatchetError.handleStatusCode(n);const s=t._vsc_buffer_bytes(i),c=t._vsc_buffer_len(i);return t.HEAPU8.slice(s,s+c)}finally{t._free(_),t._free(a),t._vsc_buffer_delete(i)}}serialize(){let e;m.ensureNotNull("this.ctxPtr",this.ctxPtr);try{e=t._vscr_ratchet_group_session_serialize(this.ctxPtr);const r=t._vsc_buffer_len(e),n=t._vsc_buffer_bytes(e);return t.HEAPU8.slice(n,n+r)}finally{t._vsc_buffer_delete(e)}}static deserialize(n){m.ensureByteArray("input",n);const s=n.length*n.BYTES_PER_ELEMENT,_=t._malloc(s);t.HEAP8.set(n,_);const c=t._vsc_data_ctx_size(),a=t._malloc(c);t._vsc_data(a,_,s);const o=t._vscr_error_ctx_size(),i=t._malloc(o);let u;t._vscr_error_reset(i);try{u=t._vscr_ratchet_group_session_deserialize(a,i);const n=t._vscr_error_status(i);return e.RatchetError.handleStatusCode(n),r.newAndTakeCContext(u)}finally{t._free(_),t._free(a),t._free(i)}}createGroupTicket(){m.ensureNotNull("this.ctxPtr",this.ctxPtr);const r=t._vscr_error_ctx_size(),n=t._malloc(r);let s;t._vscr_error_reset(n);try{s=t._vscr_ratchet_group_session_create_group_ticket(this.ctxPtr,n);const r=t._vscr_error_status(n);return e.RatchetError.handleStatusCode(r),e.RatchetGroupTicket.newAndTakeCContext(s)}finally{t._free(n)}}}return r};var N=()=>{const _=new t;return new Promise((t,c)=>{_.onRuntimeInitialized=()=>{const c={};c.FoundationError=e(),c.FoundationInterface=r(_,c),c.FoundationInterfaceTag=n(),c.FoundationImplTag=s(),c.CtrDrbg=o(_,c),c.Hmac=i(_,c),c.Hkdf=u(_,c),c.Sha512=l(_,c),c.RatchetError=f(),c.MsgType=h(),c.GroupMsgType=d(),c.RatchetCommon=y(),c.RatchetKeyId=w(_,c),c.RatchetMessage=g(_,c),c.RatchetSession=P(_,c),c.RatchetGroupParticipantsInfo=E(_,c),c.RatchetGroupMessage=x(_,c),c.RatchetGroupTicket=A(_,c),c.RatchetGroupParticipantsIds=b(_),c.RatchetGroupSession=C(_,c),t(c)},_.onAbort=t=>{c(new Error(t))}})};module.exports=N;
